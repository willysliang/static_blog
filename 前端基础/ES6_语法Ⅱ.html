<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <link rel="icon" type="image/svg+xml" href="/logo.svg"><title>Mr.Willy</title><meta name="description" content="This is willysliang blog site.">
    <link rel="preload" href="/static_blog/assets/style-BHNQQ-Mh.css" as="style"><link rel="stylesheet" href="/static_blog/assets/style-BHNQQ-Mh.css">
    <link rel="modulepreload" href="/static_blog/assets/app-Bvx-HY_0.js"><link rel="modulepreload" href="/static_blog/assets/ES6_语法Ⅱ.html-mUv9uWmB.js">
    <link rel="prefetch" href="/static_blog/assets/index.html-C-B3Vsmr.js" as="script"><link rel="prefetch" href="/static_blog/assets/CSS预处理语言.html-C0_ENamI.js" as="script"><link rel="prefetch" href="/static_blog/assets/ES6_语法.html-BAj0M7Y5.js" as="script"><link rel="prefetch" href="/static_blog/assets/Git仓库管理.html-CTKyvgRP.js" as="script"><link rel="prefetch" href="/static_blog/assets/HTML与CSS.html-dqSQzefP.js" as="script"><link rel="prefetch" href="/static_blog/assets/JavaScript.html-B5u7yoQu.js" as="script"><link rel="prefetch" href="/static_blog/assets/Nodejs.html-CEa9d1D_.js" as="script"><link rel="prefetch" href="/static_blog/assets/WEB API.html-Be6zh0rR.js" as="script"><link rel="prefetch" href="/static_blog/assets/前端杂记.html-BOSfJEUt.js" as="script"><link rel="prefetch" href="/static_blog/assets/NodeJS.html-DU0yHoYA.js" as="script"><link rel="prefetch" href="/static_blog/assets/React.html-DOVtiAgu.js" as="script"><link rel="prefetch" href="/static_blog/assets/TypeScript.html-CzDvi7lD.js" as="script"><link rel="prefetch" href="/static_blog/assets/Vue2.html-DxQYupTJ.js" as="script"><link rel="prefetch" href="/static_blog/assets/Vue3.html-v15rHRVD.js" as="script"><link rel="prefetch" href="/static_blog/assets/微信小程序.html-BkBCVe_z.js" as="script"><link rel="prefetch" href="/static_blog/assets/移动开发.html-BYhJSj3O.js" as="script"><link rel="prefetch" href="/static_blog/assets/leetCode.html-B3ypY3cK.js" as="script"><link rel="prefetch" href="/static_blog/assets/手写_原理.html-Bt9NI5Kf.js" as="script"><link rel="prefetch" href="/static_blog/assets/数据结构.html-vvVk481g.js" as="script"><link rel="prefetch" href="/static_blog/assets/设计模式.html-FQzmA7Q5.js" as="script"><link rel="prefetch" href="/static_blog/assets/前端性能优化.html-DZ3llI-B.js" as="script"><link rel="prefetch" href="/static_blog/assets/前端逻辑.html-BVTR5NGy.js" as="script"><link rel="prefetch" href="/static_blog/assets/前端面试【大纲】.html-BiCEObs-.js" as="script"><link rel="prefetch" href="/static_blog/assets/前端面试【非技术】.html-BixTjLHU.js" as="script"><link rel="prefetch" href="/static_blog/assets/前端面试题.html-BfL1aUAQ.js" as="script"><link rel="prefetch" href="/static_blog/assets/功能记录本.html-DeQd-tfD.js" as="script"><link rel="prefetch" href="/static_blog/assets/杂记本.html-C4rmEaFz.js" as="script"><link rel="prefetch" href="/static_blog/assets/项目集.html-6pjz8W6S.js" as="script"><link rel="prefetch" href="/static_blog/assets/C语言.html-ClD4TAS5.js" as="script"><link rel="prefetch" href="/static_blog/assets/JAVA.html-B1P_aa5X.js" as="script"><link rel="prefetch" href="/static_blog/assets/Linux.html-qbIKsjat.js" as="script"><link rel="prefetch" href="/static_blog/assets/数据库存储.html-C-UovGhD.js" as="script"><link rel="prefetch" href="/static_blog/assets/软件设计.html-5DZelMZ0.js" as="script"><link rel="prefetch" href="/static_blog/assets/Babel原理.html-BvyRkAkI.js" as="script"><link rel="prefetch" href="/static_blog/assets/Webpack.html-CP2LyGnx.js" as="script"><link rel="prefetch" href="/static_blog/assets/monorepo.html-BmUlKXxH.js" as="script"><link rel="prefetch" href="/static_blog/assets/电脑防治.html-CapjouOG.js" as="script"><link rel="prefetch" href="/static_blog/assets/网络安全.html-D6wqwxRO.js" as="script"><link rel="prefetch" href="/static_blog/assets/计算机网络.html-DDhwzI1h.js" as="script"><link rel="prefetch" href="/static_blog/assets/404.html-BvYNVaMk.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/static_blog/"><img class="logo" src="/static_blog/logo__icon--dark.png" alt="Mr.Willy"><span class="site-name can-hide" aria-hidden="true">Mr.Willy</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/CSS%E9%A2%84%E5%A4%84%E7%90%86%E8%AF%AD%E8%A8%80.html" aria-label="CSS预处理语言"><!--[--><!--]--> CSS预处理语言 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/ES6_%E8%AF%AD%E6%B3%95.html" aria-label="ES6+语法"><!--[--><!--]--> ES6+语法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/ES6_%E8%AF%AD%E6%B3%95%E2%85%A1.html" aria-label="ES6+语法Ⅱ"><!--[--><!--]--> ES6+语法Ⅱ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/Git%E4%BB%93%E5%BA%93%E7%AE%A1%E7%90%86.html" aria-label="Git仓库管理"><!--[--><!--]--> Git仓库管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/HTML%E4%B8%8ECSS.html" aria-label="HTML与CSS"><!--[--><!--]--> HTML与CSS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/JavaScript.html" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/Nodejs.html" aria-label="Nodejs"><!--[--><!--]--> Nodejs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/WEB%20API.html" aria-label="WEB API"><!--[--><!--]--> WEB API <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/%E5%89%8D%E7%AB%AF%E6%9D%82%E8%AE%B0.html" aria-label="前端杂记"><!--[--><!--]--> 前端杂记 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端框架"><span class="title">前端框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端框架"><span class="title">前端框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/NodeJS.html" aria-label="NodeJS"><!--[--><!--]--> NodeJS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/React.html" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/TypeScript.html" aria-label="TypeScript"><!--[--><!--]--> TypeScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/Vue2.html" aria-label="Vue2"><!--[--><!--]--> Vue2 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/Vue3.html" aria-label="Vue3"><!--[--><!--]--> Vue3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F.html" aria-label="微信小程序"><!--[--><!--]--> 微信小程序 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91.html" aria-label="移动开发"><!--[--><!--]--> 移动开发 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端算法"><span class="title">前端算法</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端算法"><span class="title">前端算法</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E7%AE%97%E6%B3%95/leetCode.html" aria-label="leetCode"><!--[--><!--]--> leetCode <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E7%AE%97%E6%B3%95/%E6%89%8B%E5%86%99_%E5%8E%9F%E7%90%86.html" aria-label="手写&amp;原理"><!--[--><!--]--> 手写&amp;原理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E7%AE%97%E6%B3%95/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E7%AE%97%E6%B3%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端进阶"><span class="title">前端进阶</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端进阶"><span class="title">前端进阶</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" aria-label="前端性能优化"><!--[--><!--]--> 前端性能优化 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E9%80%BB%E8%BE%91.html" aria-label="前端逻辑"><!--[--><!--]--> 前端逻辑 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E3%80%90%E5%A4%A7%E7%BA%B2%E3%80%91.html" aria-label="前端面试【大纲】"><!--[--><!--]--> 前端面试【大纲】 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E3%80%90%E9%9D%9E%E6%8A%80%E6%9C%AF%E3%80%91.html" aria-label="前端面试【非技术】"><!--[--><!--]--> 前端面试【非技术】 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98.html" aria-label="前端面试题"><!--[--><!--]--> 前端面试题 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%8A%9F%E8%83%BD%E8%AE%B0%E5%BD%95%E6%9C%AC.html" aria-label="功能记录本"><!--[--><!--]--> 功能记录本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E6%9D%82%E8%AE%B0%E6%9C%AC.html" aria-label="杂记本"><!--[--><!--]--> 杂记本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE%E9%9B%86.html" aria-label="项目集"><!--[--><!--]--> 项目集 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="后端基础"><span class="title">后端基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="后端基础"><span class="title">后端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80/C%E8%AF%AD%E8%A8%80.html" aria-label="C语言"><!--[--><!--]--> C语言 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80/JAVA.html" aria-label="JAVA"><!--[--><!--]--> JAVA <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80/Linux.html" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%98%E5%82%A8.html" aria-label="数据库存储"><!--[--><!--]--> 数据库存储 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="构建工具"><span class="title">构建工具</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="构建工具"><span class="title">构建工具</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/Babel%E5%8E%9F%E7%90%86.html" aria-label="Babel原理"><!--[--><!--]--> Babel原理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/Webpack.html" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/monorepo.html" aria-label="monorepo"><!--[--><!--]--> monorepo <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%94%B5%E8%84%91%E9%98%B2%E6%B2%BB.html" aria-label="电脑防治"><!--[--><!--]--> 电脑防治 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8.html" aria-label="网络安全"><!--[--><!--]--> 网络安全 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html" aria-label="计算机网络"><!--[--><!--]--> 计算机网络 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="生态系统"><span class="title">生态系统</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="生态系统"><span class="title">生态系统</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://willysliang.github.io/core" rel="noopener noreferrer" target="_blank" aria-label="HOME"><!--[--><!--]--> HOME <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://v3.cn.vuejs.org/" rel="noopener noreferrer" target="_blank" aria-label="Vue3.x"><!--[--><!--]--> Vue3.x <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://element-plus.gitee.io/zh-CN/guide/design.html" rel="noopener noreferrer" target="_blank" aria-label="Element Plus"><!--[--><!--]--> Element Plus <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/willysliang/core.git" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/CSS%E9%A2%84%E5%A4%84%E7%90%86%E8%AF%AD%E8%A8%80.html" aria-label="CSS预处理语言"><!--[--><!--]--> CSS预处理语言 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/ES6_%E8%AF%AD%E6%B3%95.html" aria-label="ES6+语法"><!--[--><!--]--> ES6+语法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/ES6_%E8%AF%AD%E6%B3%95%E2%85%A1.html" aria-label="ES6+语法Ⅱ"><!--[--><!--]--> ES6+语法Ⅱ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/Git%E4%BB%93%E5%BA%93%E7%AE%A1%E7%90%86.html" aria-label="Git仓库管理"><!--[--><!--]--> Git仓库管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/HTML%E4%B8%8ECSS.html" aria-label="HTML与CSS"><!--[--><!--]--> HTML与CSS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/JavaScript.html" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/Nodejs.html" aria-label="Nodejs"><!--[--><!--]--> Nodejs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/WEB%20API.html" aria-label="WEB API"><!--[--><!--]--> WEB API <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/%E5%89%8D%E7%AB%AF%E6%9D%82%E8%AE%B0.html" aria-label="前端杂记"><!--[--><!--]--> 前端杂记 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端框架"><span class="title">前端框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端框架"><span class="title">前端框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/NodeJS.html" aria-label="NodeJS"><!--[--><!--]--> NodeJS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/React.html" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/TypeScript.html" aria-label="TypeScript"><!--[--><!--]--> TypeScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/Vue2.html" aria-label="Vue2"><!--[--><!--]--> Vue2 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/Vue3.html" aria-label="Vue3"><!--[--><!--]--> Vue3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F.html" aria-label="微信小程序"><!--[--><!--]--> 微信小程序 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91.html" aria-label="移动开发"><!--[--><!--]--> 移动开发 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端算法"><span class="title">前端算法</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端算法"><span class="title">前端算法</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E7%AE%97%E6%B3%95/leetCode.html" aria-label="leetCode"><!--[--><!--]--> leetCode <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E7%AE%97%E6%B3%95/%E6%89%8B%E5%86%99_%E5%8E%9F%E7%90%86.html" aria-label="手写&amp;原理"><!--[--><!--]--> 手写&amp;原理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E7%AE%97%E6%B3%95/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E7%AE%97%E6%B3%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端进阶"><span class="title">前端进阶</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端进阶"><span class="title">前端进阶</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" aria-label="前端性能优化"><!--[--><!--]--> 前端性能优化 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E9%80%BB%E8%BE%91.html" aria-label="前端逻辑"><!--[--><!--]--> 前端逻辑 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E3%80%90%E5%A4%A7%E7%BA%B2%E3%80%91.html" aria-label="前端面试【大纲】"><!--[--><!--]--> 前端面试【大纲】 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E3%80%90%E9%9D%9E%E6%8A%80%E6%9C%AF%E3%80%91.html" aria-label="前端面试【非技术】"><!--[--><!--]--> 前端面试【非技术】 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98.html" aria-label="前端面试题"><!--[--><!--]--> 前端面试题 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E5%8A%9F%E8%83%BD%E8%AE%B0%E5%BD%95%E6%9C%AC.html" aria-label="功能记录本"><!--[--><!--]--> 功能记录本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E6%9D%82%E8%AE%B0%E6%9C%AC.html" aria-label="杂记本"><!--[--><!--]--> 杂记本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE%E9%9B%86.html" aria-label="项目集"><!--[--><!--]--> 项目集 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="后端基础"><span class="title">后端基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="后端基础"><span class="title">后端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80/C%E8%AF%AD%E8%A8%80.html" aria-label="C语言"><!--[--><!--]--> C语言 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80/JAVA.html" aria-label="JAVA"><!--[--><!--]--> JAVA <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80/Linux.html" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%98%E5%82%A8.html" aria-label="数据库存储"><!--[--><!--]--> 数据库存储 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="构建工具"><span class="title">构建工具</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="构建工具"><span class="title">构建工具</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/Babel%E5%8E%9F%E7%90%86.html" aria-label="Babel原理"><!--[--><!--]--> Babel原理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/Webpack.html" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/monorepo.html" aria-label="monorepo"><!--[--><!--]--> monorepo <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%94%B5%E8%84%91%E9%98%B2%E6%B2%BB.html" aria-label="电脑防治"><!--[--><!--]--> 电脑防治 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8.html" aria-label="网络安全"><!--[--><!--]--> 网络安全 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/static_blog/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html" aria-label="计算机网络"><!--[--><!--]--> 计算机网络 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="生态系统"><span class="title">生态系统</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="生态系统"><span class="title">生态系统</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://willysliang.github.io/core" rel="noopener noreferrer" target="_blank" aria-label="HOME"><!--[--><!--]--> HOME <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://v3.cn.vuejs.org/" rel="noopener noreferrer" target="_blank" aria-label="Vue3.x"><!--[--><!--]--> Vue3.x <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://element-plus.gitee.io/zh-CN/guide/design.html" rel="noopener noreferrer" target="_blank" aria-label="Element Plus"><!--[--><!--]--> Element Plus <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/willysliang/core.git" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading"> <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/static_blog/#es6-语法ii" aria-label="ES6+语法Ⅱ"><!--[--><!--]--> ES6+语法Ⅱ <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#模块化" aria-label="模块化"><!--[--><!--]--> 模块化 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/static_blog/#commonjs-nodejs" aria-label="CommonJS（nodejs）"><!--[--><!--]--> CommonJS（nodejs） <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#amd-异步-依赖前置-提前执行" aria-label="AMD（异步：依赖前置，提前执行）"><!--[--><!--]--> AMD（异步：依赖前置，提前执行） <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#cmd-异步-依赖就近-延迟执行" aria-label="CMD（异步：依赖就近，延迟执行）"><!--[--><!--]--> CMD（异步：依赖就近，延迟执行） <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#umd-模块兼容方案" aria-label="UMD（模块兼容方案）"><!--[--><!--]--> UMD（模块兼容方案） <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#es-modules-浏览器" aria-label="ES Modules（浏览器）"><!--[--><!--]--> ES Modules（浏览器） <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#闭包实现模块化" aria-label="闭包实现模块化"><!--[--><!--]--> 闭包实现模块化 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/static_blog/#模块方法" aria-label="模块方法"><!--[--><!--]--> 模块方法 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/static_blog/#动态导入-import" aria-label="动态导入 import()"><!--[--><!--]--> 动态导入 import() <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#import-meta" aria-label="import.meta"><!--[--><!--]--> import.meta <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#export-as-ns-from-mod" aria-label="export * as ns from &#39;mod&#39;"><!--[--><!--]--> export * as ns from &#39;mod&#39; <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/static_blog/#正则表达式-regexp" aria-label="正则表达式  RegExp"><!--[--><!--]--> 正则表达式  RegExp <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/static_blog/#匹配模式" aria-label="匹配模式"><!--[--><!--]--> 匹配模式 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#元字符" aria-label="[] 元字符"><!--[--><!--]--> [] 元字符 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#转义字符" aria-label="转义字符"><!--[--><!--]--> 转义字符 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#量词" aria-label="量词"><!--[--><!--]--> 量词 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#regexp-命名捕获组-name" aria-label="RegExp 命名捕获组?&lt;name&gt;"><!--[--><!--]--> RegExp 命名捕获组?&lt;name&gt; <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#regexp-unicode-属性转义" aria-label="RegExp Unicode 属性转义"><!--[--><!--]--> RegExp Unicode 属性转义 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#检测test" aria-label="检测test()"><!--[--><!--]--> 检测test() <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#regexp-反向断言-lookbehind" aria-label="RegExp 反向断言（lookbehind）"><!--[--><!--]--> RegExp 反向断言（lookbehind） <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#替换replace" aria-label="替换replace()"><!--[--><!--]--> 替换replace() <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#搜索search" aria-label="搜索search()"><!--[--><!--]--> 搜索search() <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#提取match" aria-label="提取match()"><!--[--><!--]--> 提取match() <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#拆分split" aria-label="拆分split()"><!--[--><!--]--> 拆分split() <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#regexp-prototype-exec" aria-label="RegExp.prototype.exec()"><!--[--><!--]--> RegExp.prototype.exec() <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#常规正则" aria-label="常规正则"><!--[--><!--]--> 常规正则 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/static_blog/#数据结构" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/static_blog/#set" aria-label="Set"><!--[--><!--]--> Set <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#weakset" aria-label="WeakSet"><!--[--><!--]--> WeakSet <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#map" aria-label="Map"><!--[--><!--]--> Map <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#weakmap" aria-label="WeakMap"><!--[--><!--]--> WeakMap <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#weakref" aria-label="WeakRef"><!--[--><!--]--> WeakRef <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#finalizationregistry" aria-label="FinalizationRegistry"><!--[--><!--]--> FinalizationRegistry <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/static_blog/#高阶函数" aria-label="高阶函数"><!--[--><!--]--> 高阶函数 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/static_blog/#generator生成器" aria-label="generator生成器"><!--[--><!--]--> generator生成器 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#iterator迭代器" aria-label="Iterator迭代器"><!--[--><!--]--> Iterator迭代器 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/static_blog/#象征属性-symbol" aria-label="象征属性 Symbol"><!--[--><!--]--> 象征属性 Symbol <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/static_blog/#symbol-prototype-description" aria-label="Symbol.prototype.description"><!--[--><!--]--> Symbol.prototype.description <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/static_blog/#代理对象-proxy" aria-label="代理对象 Proxy"><!--[--><!--]--> 代理对象 Proxy <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/static_blog/#get" aria-label="get()"><!--[--><!--]--> get() <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/static_blog/#承诺对象-promise" aria-label="承诺对象 Promise"><!--[--><!--]--> 承诺对象 Promise <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/static_blog/#promise创建" aria-label="Promise创建"><!--[--><!--]--> Promise创建 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#链式操作-then" aria-label="链式操作 then"><!--[--><!--]--> 链式操作 then <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#最终执行-finally" aria-label="最终执行 finally"><!--[--><!--]--> 最终执行 finally <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#promise-all" aria-label="Promise.all"><!--[--><!--]--> Promise.all <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#promise-race" aria-label="Promise.race"><!--[--><!--]--> Promise.race <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#promise-any-和-aggregateerror" aria-label="Promise.any 和 AggregateError"><!--[--><!--]--> Promise.any 和 AggregateError <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#promise-all、race、any的区别" aria-label="Promise.all、race、any的区别"><!--[--><!--]--> Promise.all、race、any的区别 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#promise-allsettled" aria-label="Promise.allSettled"><!--[--><!--]--> Promise.allSettled <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#promise封装ajax" aria-label="Promise封装Ajax"><!--[--><!--]--> Promise封装Ajax <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#回调函数的缺点" aria-label="回调函数的缺点"><!--[--><!--]--> 回调函数的缺点 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#捕获异常-try-catch" aria-label="捕获异常 try/catch"><!--[--><!--]--> 捕获异常 try/catch <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/static_blog/#异步函数-async-await" aria-label="异步函数 async/await"><!--[--><!--]--> 异步函数 async/await <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h2 id="es6-语法ii" tabindex="-1"><a class="header-anchor" href="#es6-语法ii"><span>ES6+语法Ⅱ</span></a></h2><h2 id="模块化" tabindex="-1"><a class="header-anchor" href="#模块化"><span>模块化</span></a></h2><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 模块规范化	</span>
编程语言中的模块通常是为了避免全局污染，同时更好地组织程序逻辑，方便代码复用。
		- 模块定义：如果定义私有和公开变量、属性、函数、方法
		- 模块加载：如何在运行环境中使用模块，模块之间如何相互引用
模块的加载在 nodejs 和浏览器的区别：
		- Nodejs 模块文件的后缀名为 .mjs
		- 浏览器为 script 标签


<span class="token comment">## 模块化</span>
<span class="token number">1</span>. 第一阶段：仅仅基于文件的划分模块的方式
具体做法就是将每个功能及其相关状态数据各自单独放到不同的文件中，约定每个文件就是一个独立的模块，使用某个模块就是将这个模块引入到页面中，然后直接调用模块中的成员（变量 / 函数）
缺点：所有模块都直接在全局工作，没有私有空间，所有成员都可以在模块外部被访问或者修改，而且模块过多，容易产生命名冲突，另外无法管理模块与模块之间的依赖关系


<span class="token number">2</span>. 第二阶段：【命名空间】每个模块暴露一个全局对象，所有模块成员都挂载到这个对象中
具体做法就是在第一阶段的基础上，通过将每个模块「包裹」为一个全局对象的形式实现，有点类似于为模块内的成员添加了「命名空间」。
通过「命名空间」减小了命名冲突的可能，但是同样没有私有空间，所有模块成员也可以在模块外部被访问或者修改，而且也无法管理模块之间的依赖关系。
在 JS 中，为了不污染全局变量，我们把想要访问的变量用一个「命名空间」包裹。实际上就是新建了一个包含属性的对象，避免属性直接挂载在全局变量（window/Global）上。但这个对象可任意修改，没有封闭的作用域，所以并非真正的模块。
      var moduleA <span class="token operator">=</span> <span class="token punctuation">{</span> id: <span class="token number">1</span>, name: <span class="token string">&#39;test&#39;</span> <span class="token punctuation">}</span>
      console.log<span class="token punctuation">(</span>moduleA.id<span class="token punctuation">)</span>


<span class="token number">3</span>. 第三阶段：使用立即执行函数表达式（IIFE：Immediately-Invoked Function Expression）为模块提供私有空间
具体做法就是将每个模块成员都放在一个函数提供的私有作用域中，对于需要暴露给外部的成员，通过挂在到全局对象上的方式实现
有了私有成员的概念，私有成员只能在模块成员内通过闭包的形式访问。
利用立即执行函数表达式创建一个闭包：函数内部的变量均为私有，对外暴露函数的返回值，这个闭包就成为一个模块。
      var moduleA <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function-name function">function</span>  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        var _id <span class="token operator">=</span> <span class="token number">1</span>
        var _getId <span class="token operator">=</span> <span class="token function-name function">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console.log<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">}</span>
        // 对外暴露的是返回值
        <span class="token builtin class-name">return</span> <span class="token punctuation">{</span> getId: _getId <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      moduleA._id // undefined
      moduleA._getId // undefined
      module.getId // <span class="token number">1</span>


<span class="token number">4</span>. 第四阶段： 利用 IIFE 参数作为依赖声明使用
具体做法就是在第三阶段的基础上，利用立即执行函数的参数传递模块依赖项。
这使得每一个模块之间的关系变得更加明显。


<span class="token number">5</span>. 第五阶段： 模块化规范
Require.js 提供了 AMD 模块化规范，以及一个自动化模块加载器---模块化规范的出现。
再之后便有了其他更多标准紧接而来，CommonJS、CMD。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="commonjs-nodejs" tabindex="-1"><a class="header-anchor" href="#commonjs-nodejs"><span>CommonJS（nodejs）</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## CommonJS 规范（nodejs 提出的标准）</span>
CommonJS 中一个 JS 文件就是一个模块，每个模块都有单独的作用域<span class="token punctuation">(</span>文件中的所有变量均为私有变量<span class="token punctuation">)</span>；
	通过 <span class="token variable"><span class="token variable">`</span>module.exports<span class="token variable">`</span></span> 导出一个对象，里面包含的则是公开变量；
	引用时通过 <span class="token variable"><span class="token variable">`</span>require<span class="token variable">`</span></span> 函数载入模块，其获取模块导出的对象。

缺点：CommonJS 是以同步模式加载模块，即等待所有模块加载完毕后再执行代码。
	- nodejs 执行机制是启动时加载模块，执行过程中不需要加载，只需要使用，所以不会出现问题。
	- 在五福段无需要考虑网络的场景下也是没问题的。
	- 但在浏览器，同步加载的方式可能会导致较长的网络加载时间；或会导致大量同步请求出现，因而导致效率低。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// ModuleA.js</span>
<span class="token keyword">var</span> id <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> <span class="token function-variable function">getId</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> getId <span class="token punctuation">}</span>


<span class="token comment">// ModuleB.js</span>
<span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;ModuleA.js&#39;</span><span class="token punctuation">)</span>
moduleA<span class="token punctuation">.</span>id	<span class="token comment">// undefined</span>
moduleA<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// 1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="amd-异步-依赖前置-提前执行" tabindex="-1"><a class="header-anchor" href="#amd-异步-依赖前置-提前执行"><span>AMD（异步：依赖前置，提前执行）</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## AMD（Asynchronous Module Definition）异步模块定义规范</span>
AMD 是 require.js 推出的模块规范。通过 define API函数定义和引用模块。
优势：目前绝大多数第三方库都支持 AMD 规范。
缺点：使用复杂模块划分细致，模块 JS 文件会出现请求频繁的情况。


<span class="token comment">## Require.js</span>
提供 AMD 模块化规范，以及一个自动化模块加载器，提供 require 函数加载模块。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 入口文件引入 sea.js</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;sea.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
seajs<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
 <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;js&quot;</span><span class="token punctuation">,</span>
 <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">jquery</span><span class="token operator">:</span> <span class="token string">&quot;jquery/jquery/1.10.1/jquery.js&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
seajs<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;js/main.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span> 


<span class="token comment">// moduleA.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 私有变量</span>
<span class="token keyword">var</span> id <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> <span class="token function-variable function">getId</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token comment">// 暴露模块</span>
<span class="token keyword">return</span> <span class="token punctuation">{</span> getId <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// moduleB.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token doc-comment comment">/** 第一个参数是模块引用列表 */</span><span class="token punctuation">[</span><span class="token string">&#39;moduleA&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>moduleA<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="cmd-异步-依赖就近-延迟执行" tabindex="-1"><a class="header-anchor" href="#cmd-异步-依赖就近-延迟执行"><span>CMD（异步：依赖就近，延迟执行）</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## Sea.js(淘宝推出) + CMD(通用模块定义规范)</span>
CMD是 sea.js 推广的另一个异步加载模块规范，后期也被 Require.js 兼容。
使用方式和 AMD 类似，都是在入口 html 文件中引入模块依赖包并进行配置，然后在 js 文件中根据各自规范的 API 定义和引用模块。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 入口文件引入 sea.js</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;sea.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
seajs<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
 <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;js&quot;</span><span class="token punctuation">,</span>
 <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">jquery</span><span class="token operator">:</span> <span class="token string">&quot;jquery/jquery/1.10.1/jquery.js&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
seajs<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;js/main.js&quot;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span> 


<span class="token comment">// moduleA.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 私有变量</span>
<span class="token keyword">var</span> id <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> <span class="token function-variable function">getId</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token comment">// 暴露模块</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> getId <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// moduleB.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;moduleA&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>moduleA<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="umd-模块兼容方案" tabindex="-1"><a class="header-anchor" href="#umd-模块兼容方案"><span>UMD（模块兼容方案）</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">### AMD &amp; CMD 的区别</span>
AMD 和 CMD 的区别在于依赖引入的时机。
	<span class="token number">1</span>. AMD 会将全部依赖前置，只要加载完成就会执行代码；
	<span class="token number">2</span>. CMD 则推荐将依赖就进处理，需要时再引入。

这两种方式没有优劣之分，可能从节省网络开销的角度上 CMD 会更好些；在 AMD 的方案中，若 b.doSomething<span class="token punctuation">(</span><span class="token punctuation">)</span> 是在某个条件下执行，但没有被执行到，那么模块 b 的加载是浪费的（但不影响程序执行速度）。


<span class="token comment">## UMD（模块兼容方案）</span>
UMD 不是一个模块规范，而是一个对 AMD 和 CommonJS 的兼容方案，目的是为了让模块同时能够支持浏览器和 Nodejs 两个运行。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="amd-cmd" tabindex="-1"><a class="header-anchor" href="#amd-cmd"><span>AMD &amp; CMD</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// AMD 推荐</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 依赖前置，提前执行</span>
  b<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// CMD 推荐</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  b<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 依赖就近，延迟执行</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="umd方案" tabindex="-1"><a class="header-anchor" href="#umd方案"><span>UMD方案</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">window<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Node.js 环境</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 浏览器环境，支持 AMD</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">define</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 浏览器环境，不支持 AMD</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>eventUtil <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//module ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="es-modules-浏览器" tabindex="-1"><a class="header-anchor" href="#es-modules-浏览器"><span>ES Modules（浏览器）</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## ES Modules</span>
ES6 Module 是 JavaScript 中官方支持的模块化方案，它采用 <span class="token function">import</span> 和 <span class="token builtin class-name">export</span> 关键字导入和导出模块。
ES6 模块化支持静态分析，在编译时就能够确定模块的依赖关系，因此可以进行更加高效的打包和压缩。


<span class="token comment">### ES6 Module 的使用</span>
通过 script 添加 <span class="token variable"><span class="token variable">`</span><span class="token assign-left variable">type</span><span class="token operator">=</span>module<span class="token variable">`</span></span> 的属性使用 ES Modules。
    <span class="token number">1</span>. ESM 自动采用严格模式，忽略 <span class="token string">&#39;use strict&#39;</span>。
    <span class="token number">2</span>. 每个 ES Module 都是运行在单独的私有作用域中。
    <span class="token number">3</span>. ESM 是通过 CORS 的方式请求外部 JS 模块的。
    <span class="token number">4</span>. ESM 的 script 标签会延迟执行脚本。


<span class="token comment">### CommonJS 与 ES Modules 的区别</span>
<span class="token number">1</span>. 使用语法层面，CommonJs是通过module.exports，exports导出，require导入；ESModule则是export导出，import导入
<span class="token number">2</span>. CommonJs是运行时加载模块，ESModule是在静态编译期间就确定模块的依赖
<span class="token number">3</span>. ESModule在编译期间会将所有import提升到顶部，CommonJs不会提升require
<span class="token number">4</span>. CommonJs导出的是一个值拷贝，会对加载结果进行缓存，一旦内部再修改这个值，则不会同步到外部。ESModule是导出的一个引用，内部修改可以同步到外部
<span class="token number">5</span>. CommonJs中顶层的this指向这个模块本身，而ESModule中顶层this指向undefined
<span class="token number">6</span>. CommonJS加载的是整个模块，将所有的接口全部加载进来，ESModule可以单独加载其中的某个接口


<span class="token comment">### 导出字面量和导出模块的区别</span>
    导出字面量<span class="token punctuation">(</span>如:对象<span class="token punctuation">)</span>:export default <span class="token punctuation">{</span> name, age <span class="token punctuation">}</span>
    注意: <span class="token function">import</span> <span class="token punctuation">{</span>name, age<span class="token punctuation">}</span> from <span class="token string">&#39;modulename&#39;</span>导入模块无法使用到name和age的值

    导出模块:
      <span class="token builtin class-name">export</span> <span class="token punctuation">{</span> name, age <span class="token punctuation">}</span>
      <span class="token function">import</span> <span class="token punctuation">{</span>name, age<span class="token punctuation">}</span> from <span class="token string">&#39;modulename&#39;</span> 导入模块可以使用到name和age的值
		原因：import导入的是对模块内部的使用

		注意：export暴露的是模块的引用关系<span class="token punctuation">(</span>地址<span class="token punctuation">)</span>，并且只读不可修改<span class="token punctuation">(</span>尝试修改会报错误<span class="token punctuation">)</span>


<span class="token comment">### 导出</span>
<span class="token number">1</span>. CommonJS 中是先将模块整体导入为一个对象，然后从对象中结构出需要的成员 
			const <span class="token punctuation">{</span> name, age <span class="token punctuation">}</span> <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">&#39;./module.js&#39;</span><span class="token punctuation">)</span>
<span class="token number">2</span>. ES Module 中 <span class="token punctuation">{</span> <span class="token punctuation">}</span> 是固定语法，就是直接提取模块导出成员 
			<span class="token function">import</span> <span class="token punctuation">{</span> name, age <span class="token punctuation">}</span> from <span class="token string">&#39;./module.js&#39;</span>
<span class="token number">3</span>. ES Modules 导入成员并不是复制一个副本，而是直接导入模块成员的引用地址。
		即 <span class="token function">import</span> 得到的变量与 <span class="token builtin class-name">export</span> 导入的变量在内存中是同一块空间。一旦模块中成员修改了，这里也会同时修改。
<span class="token number">4</span>. 导入模块成员变量是只读的 
			name <span class="token operator">=</span> <span class="token string">&#39;tom&#39;</span> // 报错
<span class="token number">5</span>. 导入的是一个对象，对象的属性读写不受影响 
			name.xxx <span class="token operator">=</span> <span class="token string">&#39;xxx&#39;</span> // 正常
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// ModuleA.js</span>
<span class="token keyword">var</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">// 可以直接导出变量</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getId</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 也可以整体导出模块</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> getId <span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">// ModuleB.js</span>
<span class="token keyword">import</span> moduleA <span class="token keyword">from</span> <span class="token string">&#39;moduleA.js&#39;</span>
moduleA<span class="token punctuation">.</span>id<span class="token punctuation">;</span> <span class="token comment">// undefined</span>
moduleA<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h4 id="es-modules-in-node-js-与-commonjs-的差异" tabindex="-1"><a class="header-anchor" href="#es-modules-in-node-js-与-commonjs-的差异"><span>ES Modules in Node.js - 与 CommonJS 的差异</span></a></h4><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## ES Modules in Node.js - 与 CommonJS 的差异</span>
<span class="token number">1</span>、ESM 中无法引用 CommonJS 中的那些模块全局成员
<span class="token number">2</span>、require, module, exports 可通过 <span class="token function">import</span> 和 <span class="token builtin class-name">export</span> 代替
<span class="token number">3</span>、__filename 和 __dirname 通过 <span class="token function">import</span> 对象的 meta 属性获取
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/** CommonJS */</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>require<span class="token punctuation">)</span> <span class="token comment">// 加载模块函数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span> <span class="token comment">// 模块对象</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>exports<span class="token punctuation">)</span> <span class="token comment">// 导出对象别名</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span> <span class="token comment">// 当前文件的绝对路径</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span> <span class="token comment">// 当前文件所在目录</span>


<span class="token doc-comment comment">/** ES Modules */</span>
<span class="token comment">// 通过 url 模块的 fileURLToPath 方法转换为路径</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fileURLToPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;url&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> dirname <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;path&#39;</span>
<span class="token keyword">const</span> __filename <span class="token operator">=</span> <span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
<span class="token keyword">const</span> __dirname <span class="token operator">=</span> <span class="token function">dirname</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span>
<span class="token keyword">const</span> currentUrl <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>currentUrl<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h4 id="es-module工作原理" tabindex="-1"><a class="header-anchor" href="#es-module工作原理"><span>ES Module工作原理</span></a></h4><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## ES Module 的工作原理</span>
浏览器通过Module Record的数据结构。每个 Module Record 包含：
    - ECMAScript Code: AST 语法树
    - 需要请求的模块
        - moduleA.js
        - moduleB.js
    - 请求模块的入口
        - <span class="token function">import</span> CustomModule from <span class="token string">&#39;moduleA.js&#39;</span><span class="token builtin class-name">:</span> CustomModule 就是模块入口
    - 其它属性和方法


Module Record 再转换成为包含 code 和 state 的 Module Instance。转换的过程分三步：
    <span class="token number">1</span>. 构造（Construction）
    <span class="token number">2</span>. 实例化（Instantiation）
    <span class="token number">3</span>. 求值（Evaluation）

ES modules: A cartoon deep-dive 构造每个 Module 在构造阶段要执行三个操作：
    <span class="token number">1</span>. 找到包含模块的文件
    <span class="token number">2</span>. 下载文件
    <span class="token number">3</span>. 将文件解析为 Module Record


上述这两个步骤和运行时相关，例如浏览器中文件通过 script 标签引入的；而 Node.js 中文件从文件系统中引入。

浏览器会建立一个 Module Map，当请求一个 URL 时，浏览器把这个 URL 放入 Module Map，并将其打上标记来标识正在下载该文件。之后就发送请求获取该文件，然后继续获取下一个文件；同时 Module Map 也充当起模块缓存的作用，当请求的 URL 已存在时，会直接从 Map 中取得模块。

当文件下载完成后，浏览器会将文件转换为 Module Record，然后保存在 Module Map 中。实例化是给各个 Module Record 中 <span class="token builtin class-name">export</span> 的变量和函数分配内存地址，接着将其它模块中对应的 <span class="token function">import</span> 部分，指向对应的 <span class="token builtin class-name">export</span> 内存地址。JS 引擎会深度优先遍历模块树，此时变量和函数只分配内存地址，没有值。赋值在最后一步进行。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="闭包实现模块化" tabindex="-1"><a class="header-anchor" href="#闭包实现模块化"><span>闭包实现模块化</span></a></h3><blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">/* 状态模块（存变量） */</span>
<span class="token keyword">var</span> module_status <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> status <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">number</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">prop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> status<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">set</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">prop<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    status<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> get<span class="token punctuation">,</span> set<span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* 功能模块（调用状态） */</span>
<span class="token keyword">var</span> module_color <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//用这种方式执行第二步引入操作，类似 import state from &#39;module_status&#39;</span>
  <span class="token keyword">var</span> state <span class="token operator">=</span> module_status<span class="token punctuation">;</span>
  <span class="token keyword">var</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;orange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ccc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pink&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> colors<span class="token punctuation">[</span>state<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token operator">%</span> colors<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;color&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> render<span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> module_context <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> state <span class="token operator">=</span> module_status<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;this Number is&quot;</span> <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> render<span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* 主模块（执行功能模块） */</span>
<span class="token keyword">var</span> module_main <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> state <span class="token operator">=</span> module_status<span class="token punctuation">;</span>
  <span class="token keyword">var</span> color <span class="token operator">=</span> module_color<span class="token punctuation">;</span>
  <span class="token keyword">var</span> context <span class="token operator">=</span> module_context<span class="token punctuation">;</span>

  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span> state<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    color<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h2 id="模块方法" tabindex="-1"><a class="header-anchor" href="#模块方法"><span>模块方法</span></a></h2><h3 id="动态导入-import" tabindex="-1"><a class="header-anchor" href="#动态导入-import"><span>动态导入 <code>import()</code></span></a></h3><blockquote><p>在此之前，我们只能使用静态导入，它只接受模块路径的字符串。使用动态导入，我们必须使用 Promise 有条件地导入模块。</p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>books.html<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-entry-module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>books<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Books<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>movies.html<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-entry-module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>movies<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Movies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video-games.html<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-entry-module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video-games<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Video Games<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">&gt;</span></span>Content will load here!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> main <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;main&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> link <span class="token keyword">of</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&#39;nav &gt; a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  link<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./section-modules/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>link<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>entryModule<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      module<span class="token punctuation">.</span><span class="token function">loadPageInto</span><span class="token punctuation">(</span>main<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      main<span class="token punctuation">.</span>textContent <span class="token operator">=</span> err<span class="token punctuation">.</span>message
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="import-meta" tabindex="-1"><a class="header-anchor" href="#import-meta"><span><code>import.meta</code></span></a></h3><blockquote><p>用于保存有关当前模块的特定于主机的元数据的<strong>元属性</strong>。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">&#39;../hamsters.jpg&#39;</span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>scriptElement<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>size <span class="token operator">||</span> <span class="token number">300</span>

  <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  image<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
  image<span class="token punctuation">.</span>width <span class="token operator">=</span> image<span class="token punctuation">.</span>height <span class="token operator">=</span> size

  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="export-as-ns-from-mod" tabindex="-1"><a class="header-anchor" href="#export-as-ns-from-mod"><span><code>export * as ns from &#39;mod&#39;</code></span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">### `export * as ns from &#39;mod&#39;`</span>
语法：<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">export</span> * as nameSpaceStr from <span class="token string">&#39;modulePath&#39;</span><span class="token variable">`</span></span>


- 为了确保有一个默认导出， <span class="token punctuation">[</span>Airbnb 规范<span class="token punctuation">]</span><span class="token punctuation">(</span>https://github.com/airbnb/javascript<span class="token punctuation">)</span>建议不要使用通配符导入。
- 不要直接从 <span class="token function">import</span> 中 export，使用一种清晰的导入方式和一种清晰的导出方式可以使事情保持一致。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">as</span> ns <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span>

<span class="token comment">// 👆 等同于 👇</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ns <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> ns <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>确保存在一个默认导出</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// bad</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> AirbnbStyleGuide <span class="token keyword">from</span> <span class="token string">&#39;./AirbnbStyleGuide&#39;</span>

<span class="token comment">// good</span>
<span class="token keyword">import</span> AirbnbStyleGuide <span class="token keyword">from</span> <span class="token string">&#39;./AirbnbStyleGuide&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// bad</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> es6 <span class="token keyword">as</span> <span class="token keyword">default</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./AirbnbStyleGuide&#39;</span>

<span class="token comment">// good</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> es6 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./AirbnbStyleGuide&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> es6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="正则表达式-regexp" tabindex="-1"><a class="header-anchor" href="#正则表达式-regexp"><span>正则表达式 RegExp</span></a></h2><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">### 正则表达式 RegExp </span>

<span class="token comment">### 正则作用</span>
    - 检索、替换符合某个模式（规则）的文本
    - 过滤页面内容中的一些敏感词（替换）
    - 从字符串中获取特定部分（提取）



<span class="token comment">### 创建正则表达式</span>
<span class="token number">1</span>. 通过 <span class="token variable"><span class="token variable">`</span>RegExp<span class="token variable">`</span></span> 对象的构造函数创建正则表达式
		- <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">let</span> reg <span class="token operator">=</span> new RegExp<span class="token punctuation">(</span>/正则表达式/<span class="token punctuation">)</span><span class="token variable">`</span></span>
		- <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">let</span> reg <span class="token operator">=</span> new RegExp<span class="token punctuation">(</span>字符串, 匹配模式修饰符Flag<span class="token punctuation">)</span><span class="token variable">`</span></span>

<span class="token number">2</span>. 通过字面量创建
		- <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">let</span> reg <span class="token operator">=</span> /表达式/<span class="token variable">`</span></span>
		- <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">let</span> reg <span class="token operator">=</span> /正则表达式/匹配模式<span class="token variable">`</span></span>



<span class="token comment">### 字符串的正则方法</span>
字符串对象共有 <span class="token number">4</span> 个方法，可以使用正则表达式：match<span class="token punctuation">(</span><span class="token punctuation">)</span>、replace<span class="token punctuation">(</span><span class="token punctuation">)</span>、search<span class="token punctuation">(</span><span class="token punctuation">)</span>和split<span class="token punctuation">(</span><span class="token punctuation">)</span>。
ES6 将这 <span class="token number">4</span> 个方法，在语言内部全部调用RegExp的实例方法，从而做到所有与正则相关的方法，全都定义在RegExp对象上。
    - String.prototype.match 调用 RegExp.prototype<span class="token punctuation">[</span>Symbol.match<span class="token punctuation">]</span>
    - String.prototype.replace 调用 RegExp.prototype<span class="token punctuation">[</span>Symbol.replace<span class="token punctuation">]</span>
    - String.prototype.search 调用 RegExp.prototype<span class="token punctuation">[</span>Symbol.search<span class="token punctuation">]</span>
    - String.prototype.split 调用 RegExp.prototype<span class="token punctuation">[</span>Symbol.split<span class="token punctuation">]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="匹配模式" tabindex="-1"><a class="header-anchor" href="#匹配模式"><span>匹配模式</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 匹配模式</span>
<span class="token comment">### `i`：指忽略大小写 ignore</span>


<span class="token comment">### `g`：指全局匹配模式 global</span>
    - 全局匹配模式<span class="token variable"><span class="token variable">`</span>g<span class="token variable">`</span></span>一般用于 <span class="token variable"><span class="token variable">`</span>exec<span class="token punctuation">(</span><span class="token punctuation">)</span>、match<span class="token punctuation">(</span><span class="token punctuation">)</span>、replace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> 等方法
    - 全局匹配模式<span class="token variable"><span class="token variable">`</span>g<span class="token variable">`</span></span>如果用于test<span class="token punctuation">(</span><span class="token punctuation">)</span>方法会有问题。因为g模式会生成一个<span class="token variable"><span class="token variable">`</span>lastindex<span class="token variable">`</span></span>参数来存储匹配最后一次的位置。


<span class="token comment">### `y`：指黏连 sticky</span>
    - 类似全局匹配，后一次匹配都从上一次匹配成功的下一个位置开始；
    - <span class="token variable"><span class="token variable">`</span>g<span class="token variable">`</span></span>修饰符只要剩余位置中存在匹配就行，而<span class="token variable"><span class="token variable">`</span>y<span class="token variable">`</span></span>修饰符确保匹配必须从剩余的第一个位置开始。


<span class="token comment">### `u` 修饰符：含义为 Unicode 模式</span>
		- 用来正确处理大于<span class="token variable"><span class="token variable">`</span><span class="token punctuation">\</span>uFFFF<span class="token variable">`</span></span> 的 Unicode 字符，即会正确处理四个字节的UTF-16编码。
		- 在 ES5 中不支持四个字节的 UTF-16 编码，会将其识别为两个字符；加上 <span class="token variable"><span class="token variable">`</span>u<span class="token variable">`</span></span> 修饰符后，ES6就会识别其为一个字符。
		- 如：<span class="token variable"><span class="token variable">`</span>/𠮷<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span>/u.test<span class="token punctuation">(</span><span class="token string">&#39;𠮷𠮷&#39;</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token boolean">true</span><span class="token variable">`</span></span>。
          /^<span class="token punctuation">\</span>uD83D/u.test<span class="token punctuation">(</span><span class="token string">&#39;\uD83D\uDC2A&#39;</span><span class="token punctuation">)</span> // <span class="token boolean">false</span>
          /^<span class="token punctuation">\</span>uD83D/.test<span class="token punctuation">(</span><span class="token string">&#39;\uD83D\uDC2A&#39;</span><span class="token punctuation">)</span> // <span class="token boolean">true</span>


<span class="token comment">### `.` 修饰符：含义是除了换行符以外的任意单个字符</span>
		- 对于码点大于0xFFFF的 Unicode 字符，点字符不能识别，必须加上u修饰符。



<span class="token comment">### `s` 修饰符：dotAll 模式</span>
正则表达式中，点（.）是一个特殊字符，代表任意的单个字符，但是有两个例外。一个是四个字节的 UTF-16 字符，这个可以用u修饰符解决；另一个是行终止符（line terminator character）。
所谓行终止符，就是该字符表示一行的终结。以下四个字符属于“行终止符”。
    - U+000A 换行符（<span class="token punctuation">\</span>n）
    - U+000D 回车符（<span class="token punctuation">\</span>r）
    - U+2028 行分隔符（line separator）
    - U+2029 段分隔符（paragraph separator）

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h4 id="y-修饰符" tabindex="-1"><a class="header-anchor" href="#y-修饰符"><span><code>y</code> 修饰符</span></a></h4><blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">&#39;aaa_aa_a&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> r1 <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token keyword">var</span> r2 <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">y</span></span><span class="token punctuation">;</span>
r1<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// [&quot;aaa&quot;]</span>
r2<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// [&quot;aaa&quot;]</span>
r1<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// [&quot;aa&quot;]</span>
r2<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// null</span>



<span class="token doc-comment comment">/** g修饰符通过 lastIndex 来排查 */</span>
<span class="token keyword">const</span> <span class="token constant">REGEX</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token comment">// 指定从2号位置（y）开始匹配</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span>lastIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">// 匹配成功</span>
<span class="token keyword">const</span> match <span class="token operator">=</span> <span class="token constant">REGEX</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;xaya&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 在3号位置匹配成功</span>
match<span class="token punctuation">.</span>index <span class="token comment">// 3</span>
<span class="token comment">// 下一次匹配从4号位开始</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span>lastIndex <span class="token comment">// 4</span>
<span class="token comment">// 4号位开始匹配失败</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;xaya&#39;</span><span class="token punctuation">)</span> <span class="token comment">// null</span>



<span class="token doc-comment comment">/** y修饰符通过 lastIndex 来排查 */</span>
<span class="token keyword">const</span> <span class="token constant">REGEX</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a</span><span class="token regex-delimiter">/</span><span class="token regex-flags">y</span></span><span class="token punctuation">;</span>
<span class="token comment">// 指定从2号位置开始匹配</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span>lastIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">// 不是粘连，匹配失败</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;xaya&#39;</span><span class="token punctuation">)</span> <span class="token comment">// null</span>
<span class="token comment">// 指定从3号位置开始匹配</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span>lastIndex <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">// 3号位置是粘连，匹配成功</span>
<span class="token keyword">const</span> match <span class="token operator">=</span> <span class="token constant">REGEX</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;xaya&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
match<span class="token punctuation">.</span>index <span class="token comment">// 3</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span>lastIndex <span class="token comment">// 4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h4 id="u修饰符" tabindex="-1"><a class="header-anchor" href="#u修饰符"><span><code>u</code>修饰符</span></a></h4><blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/** u 修饰符 */</span>
<span class="token operator">/</span><span class="token operator">^</span>\uD83D<span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;\uD83D\uDC2A&#39;</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span><span class="token operator">^</span>\uD83D<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;\uD83D\uDC2A&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>


<span class="token doc-comment comment">/** 点修饰符 与 u 修饰符搭配 */</span>
<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^.$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;𠮷&#39;</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span><span class="token operator">^</span><span class="token punctuation">.</span>$<span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;𠮷&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token comment">// 上面代码如果不添加u修饰符，正则表达式就会认为字符串为两个字符，从而匹配失败。</span>



<span class="token doc-comment comment">/** Unicode 字符表示法 */</span>
<span class="token comment">// 使用大括号表示 Unicode 字符，这种表示法在正则表达式中必须加上`u`修饰符，才能识别当中的大括号，否则会被解读为量词。</span>
<span class="token operator">/</span>\u<span class="token punctuation">{</span><span class="token number">61</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span>\u<span class="token punctuation">{</span><span class="token number">61</span><span class="token punctuation">}</span><span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token operator">/</span>\u<span class="token punctuation">{</span>20BB7<span class="token punctuation">}</span><span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;𠮷&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>



<span class="token doc-comment comment">/** 量词 */</span>
<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a{2}</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;aa&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token operator">/</span>a<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;aa&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token operator">/</span>𠮷<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;𠮷𠮷&#39;</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span>𠮷<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;𠮷𠮷&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>



<span class="token doc-comment comment">/** 预定义模式 */</span>
<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\S$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;𠮷&#39;</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span><span class="token operator">^</span>\<span class="token constant">S</span>$<span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;𠮷&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h4 id="s-修饰符" tabindex="-1"><a class="header-anchor" href="#s-修饰符"><span><code>s</code> 修饰符</span></a></h4><blockquote><p>正则表达式中，点（<code>.</code>）是一个特殊字符，代表任意的单个字符，但是有两个例外。一个是四个字节的 UTF-16 字符，这个可以用<code>u</code>修饰符解决；另一个是行终止符（line terminator character）。</p><p>所谓行终止符，就是该字符表示一行的终结。以下四个字符属于“行终止符”。</p><ul><li>U+000A 换行符（<code>\n</code>）</li><li>U+000D 回车符（<code>\r</code>）</li><li>U+2028 行分隔符（line separator）</li><li>U+2029 段分隔符（paragraph separator）</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">foo.bar</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;foo\nbar&#39;</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面代码中，因为<code>.</code>不匹配<code>\n</code>，所以正则表达式返回<code>false</code>。</p><p>但是，很多时候希望匹配的是任意单个字符，这时有一种变通的写法。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">foo[^]bar</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;foo\nbar&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这种解决方案毕竟不太符合直觉，ES2018引入 <code>s</code>修饰符，使得<code>.</code>可以匹配任意单个字符。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">foo.bar</span><span class="token regex-delimiter">/</span><span class="token regex-flags">s</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;foo\nbar&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这被称为<code>dotAll</code>模式，即点（dot）代表一切字符。所以，正则表达式还引入了一个<code>dotAll</code>属性，返回一个布尔值，表示该正则表达式是否处在<code>dotAll</code>模式。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">foo.bar</span><span class="token regex-delimiter">/</span><span class="token regex-flags">s</span></span><span class="token punctuation">;</span>

<span class="token comment">// 另一种写法</span>
<span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&#39;foo.bar&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;s&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
re<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;foo\nbar&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
re<span class="token punctuation">.</span>dotAll <span class="token comment">// true</span>
re<span class="token punctuation">.</span>flags <span class="token comment">// &#39;s&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>/s</code>修饰符和多行修饰符<code>/m</code>不冲突，两者一起使用的情况下，<code>.</code>匹配所有字符，而<code>^</code>和<code>$</code>匹配每一行的行首和行尾。</p></blockquote><h4 id="dotall-模式" tabindex="-1"><a class="header-anchor" href="#dotall-模式"><span>dotAll 模式</span></a></h4><blockquote><p><strong>dotAll 模式</strong>，即点（dot）代表一切字符。所以，正则表达式中点（<code>.</code>）匹配除行终止符外的任何单字符，ES9 引入 <code>s</code> 修饰符可以改变这种行为，允许**行终止符（line terminator character）**的出现。</p><p>所谓行终止符，就是该字符表示一行的终结。以下四个字符属于“行终止符”。</p><ul><li>U+000A 换行符（<code>\n</code>）</li><li>U+000D 回车符（<code>\r</code>）</li><li>U+2028 行分隔符（line separator）</li><li>U+2029 段分隔符（paragraph separator）</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token punctuation">;</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">hello.world</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;hello\nworld&#39;</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token comment">// false</span>
<span class="token operator">/</span>hello<span class="token punctuation">.</span>world<span class="token operator">/</span>s<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;hello\nworld&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>正则表达式还引入了一个 <code>dotAll</code> 属性，返回一个布尔值，表示该正则表达式是否处在 <code>dotAll</code> 模式。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">foo.bar</span><span class="token regex-delimiter">/</span><span class="token regex-flags">s</span></span>

reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;foo\nbar&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
reg<span class="token punctuation">.</span>dotAll <span class="token comment">// true</span>
reg<span class="token punctuation">.</span>flags <span class="token comment">// &#39;s&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>/s</code> 修饰符和多行修饰符 <code>/m</code> 不冲突，两者一起使用的情况下，<code>.</code> 匹配所有字符，而 <code>^</code> 和 <code>$</code> 匹配每一行的行首和行尾。</p></blockquote><h3 id="元字符" tabindex="-1"><a class="header-anchor" href="#元字符"><span><code>[]</code> 元字符</span></a></h3><h4 id="值-值-范围" tabindex="-1"><a class="header-anchor" href="#值-值-范围"><span>[ 值- 值] 范围</span></a></h4><blockquote><ul><li><code>/[ab]/</code> 等价于 <code>/a|b/</code>：检查一个字符串中是否包含 <strong>a或b</strong></li><li><code>/[a-z]/</code>：检查一个字符串那种是否包含<strong>任意小写字母</strong></li><li><code>/[A-Z]/</code>：任意大写字母</li><li><code>/[A-z]/</code>：任意字母</li><li><code>/[0-9]/</code>：任意数字</li><li><code>[a-z0-9A-Z]</code>：任意数字、字母</li><li><code>/a[bde]c/</code>：检查一个字符串中是否包含 abc 或 adc 或 aec</li></ul></blockquote><h4 id="值-排除" tabindex="-1"><a class="header-anchor" href="#值-排除"><span><code>[^值]</code> 排除</span></a></h4><blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 举例1：</span>
<span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[^ab]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span> <span class="token comment">// 规则：字符串中，除了a、b之外，还有没有其他的字符内容？</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;acb&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印结果：true</span>

<span class="token comment">// 举例2：（可以用来验证某字符串是否为 纯数字）</span>
<span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[^0-9]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>  <span class="token comment">// 规则：字符串中，除了数字之外，还有没有其他的内容？</span>
<span class="token keyword">var</span> str1 <span class="token operator">=</span> <span class="token string">&quot;1991&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> str2 <span class="token operator">=</span> <span class="token string">&quot;199a1&quot;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印结果：false （如果字符串是 纯数字，则返回 false）</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印结果：true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="转义字符" tabindex="-1"><a class="header-anchor" href="#转义字符"><span>转义字符</span></a></h3><blockquote><ul><li><code>.</code>(点) ：任意字符</li><li><code>\d</code> (数字)：<code>[0-9]</code></li><li><code>\w</code> (数字、英文、下划线) ：<code>[a-z0-9_]</code></li><li><code>\s</code> (空白字符)：<code>[ ]</code></li><li><code>\D</code> (除了数字)：<code>[^0-9]</code></li><li><code>\W</code> (除了数字英文下划线) ：<code>[^a-z0-9_]</code></li><li><code>\S</code> (除了空白字符)：<code>[^ ]</code></li><li>``^` ：行首</li><li><code>$</code>：行尾</li></ul></blockquote><h3 id="量词" tabindex="-1"><a class="header-anchor" href="#量词"><span>量词</span></a></h3><blockquote><ul><li><code>{n}</code>：刚好出现 n 次</li><li><code>{n,m}</code> 至少出现 n 次，最多 m 次</li><li><code>{n,}</code> 至少 n 次，无上限</li><li><code>*</code> 任意次 <code>{0,}</code> 可以为0次，不建议使用</li><li><code>？</code> 零次或一次 <code>{0,1}</code></li><li><code>+</code> 一次或任意次<code>{1,}</code></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 固定电话:010-23456789-1234 或 23456789</span>
<span class="token punctuation">(</span><span class="token number">0</span>\d<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token operator">-</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span>\d<span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token operator">-</span>\d<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">?</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="regexp-命名捕获组-name" tabindex="-1"><a class="header-anchor" href="#regexp-命名捕获组-name"><span>RegExp 命名捕获组<code>?&lt;name&gt;</code></span></a></h3><blockquote><p>JavaScript 正则表达式可以返回一个匹配的对象 —— 一个包含匹配字符串的类数组，例如：以 <code>YYYY-MM-DD</code> 的格式解析日期：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> reDate <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">([0-9]{4})-([0-9]{2})-([0-9]{2})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
match <span class="token operator">=</span> reDate<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;2018-04-30&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
year <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 2018</span>
month <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 04</span>
day <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">// 30</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样的代码很难读懂，并且改变正则表达式的结构有可能改变匹配对象的索引。</p><p>ES9 允许命名捕获组使用符号 <code>?&lt;name&gt;</code>，在打开捕获括号 <code>(</code> 后立即命名，示例如下：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> reDate <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;year&gt;[0-9]{4})-(?&lt;month&gt;[0-9]{2})-(?&lt;day&gt;[0-9]{2})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
match <span class="token operator">=</span> reDate<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;2018-04-30&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
year <span class="token operator">=</span> match<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>year<span class="token punctuation">,</span> <span class="token comment">// 2018</span>
month <span class="token operator">=</span> match<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>month<span class="token punctuation">,</span> <span class="token comment">// 04</span>
day <span class="token operator">=</span> match<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>day <span class="token comment">// 30</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>任何匹配失败的命名组都将返回 <code>undefined</code>。</p><p>命名捕获也可以使用在 <code>replace()</code> 方法中。例如将日期转换为美国的 <code>MM-DD-YYYY</code> 格式：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> reDate <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;year&gt;[0-9]{4})-(?&lt;month&gt;[0-9]{2})-(?&lt;day&gt;[0-9]{2})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
d <span class="token operator">=</span> <span class="token string">&#39;2018-04-30&#39;</span><span class="token punctuation">,</span>
usDate <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>reDate<span class="token punctuation">,</span> <span class="token string">&#39;$&lt;month&gt;-$&lt;day&gt;-$&lt;year&gt;&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="regexp-unicode-属性转义" tabindex="-1"><a class="header-anchor" href="#regexp-unicode-属性转义"><span>RegExp Unicode 属性转义</span></a></h3><blockquote><p>在 ES9 之前，在正则表达式中访问 Unicode 字符属性是不被允许的。</p><p>ES9 添加了 Unicode 属性转义，形式为 <code>\p{...}</code> 和 <code>\P{...}</code>，在正则表达式中使用标记 <code>u</code> （unicode）设置，在 <code>\p</code> 块内，可以以键值对的方式设置需要匹配的属性而非具体内容。例如：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> reGreekSymbol <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\p{Script=Greek}</span><span class="token regex-delimiter">/</span><span class="token regex-flags">u</span></span>
reGreekSymbol<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;π&#39;</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>此特性可以避免使用特定 Unicode 区间来进行内容类型判断，提升可读性和可维护性。</p></blockquote><h3 id="检测test" tabindex="-1"><a class="header-anchor" href="#检测test"><span>检测<code>test()</code></span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 检测 test()</span>
- <span class="token variable"><span class="token variable">`</span>regExp.test<span class="token punctuation">(</span>要测试的文本str<span class="token punctuation">)</span><span class="token variable">`</span></span>：只要正则表达式匹配，就返回 <span class="token boolean">true</span>
- 对于 <span class="token string">&#39;非全局匹配&#39;</span> 的正则表达式，test<span class="token punctuation">(</span><span class="token punctuation">)</span> 只会检测 <span class="token string">&#39;是否存在某个目标字符串&#39;</span><span class="token punctuation">(</span>只要存在就为 <span class="token boolean">true</span><span class="token punctuation">)</span>，多次检测的见过都相同。
- 注意：全局匹配 g 慎用 test<span class="token punctuation">(</span><span class="token punctuation">)</span> 方法，因为每次检测的结果可能会出现不一致。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">test</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">&#39;_test_test&#39;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="regexp-反向断言-lookbehind" tabindex="-1"><a class="header-anchor" href="#regexp-反向断言-lookbehind"><span>RegExp 反向断言（lookbehind）</span></a></h3><blockquote><p>目前 JavaScript 在正则表达式中支持先行断言（lookahead）。这意味着匹配会发生，但不会有任何捕获，并且断言没有包含在整个匹配字段中。例如从价格中捕获货币符号：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> reLookahead <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\D(?=\d+)</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">const</span> match <span class="token operator">=</span> reLookahead<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;$123.89&#39;</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// $</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ES9 引入以相同方式工作但是匹配前面的反向断言（lookbehind），这样我就可以忽略货币符号，单纯的捕获价格的数字：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> reLookbehind <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=\D)\d+</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">const</span> match <span class="token operator">=</span> reLookbehind<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;$123.89&#39;</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 123.89</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以上是<strong>肯定反向断言</strong>，非数字 <code>\D</code> 必须存在。同样的，还存在<strong>否定反向断言</strong>，表示一个值必须不存在，例如：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> reLookbehindNeg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;!\D)\d+</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">const</span> match <span class="token operator">=</span> reLookbehind<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;$123.89&#39;</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// null</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="替换replace" tabindex="-1"><a class="header-anchor" href="#替换replace"><span>替换<code>replace()</code></span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 替换 replace()</span>
- <span class="token variable"><span class="token variable">`</span>replace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span>：将字符串中的指定内容替换为新的内容并返回。不会修改原字符串。
- <span class="token variable"><span class="token variable">`</span>新的字符串 <span class="token operator">=</span> 原字符串.replace<span class="token punctuation">(</span>被替换的内容, 要替换的新内容<span class="token punctuation">)</span><span class="token variable">`</span></span>

- 对于不带标志 <span class="token variable"><span class="token variable">`</span>/g<span class="token variable">`</span></span> 的正则表达式，replace<span class="token punctuation">(</span><span class="token punctuation">)</span> 只访问第一个匹配项。
- 若在正则表达还是后面加上 <span class="token variable"><span class="token variable">`</span>/g<span class="token variable">`</span></span>，replace<span class="token punctuation">(</span><span class="token punctuation">)</span> 会执行多次。



<span class="token comment">### replaceAll()</span>
- <span class="token variable"><span class="token variable">`</span>replaceAll<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> 替换正则表达式或字符串的所有匹配项。
- <span class="token variable"><span class="token variable">`</span>String.prototype.replaceAll<span class="token punctuation">(</span>searchValue, replaceValue<span class="token punctuation">)</span><span class="token variable">`</span></span>
		- <span class="token variable"><span class="token variable">`</span>searchValue<span class="token variable">`</span></span> 可以是一个字符串或正则表达式。
		
		- <span class="token variable"><span class="token variable">`</span>.*<span class="token variable">`</span></span> — 单个字符匹配任意次，即贪婪匹配
    - <span class="token variable"><span class="token variable">`</span>u<span class="token variable">`</span></span> — Unicode 模式
    - <span class="token variable"><span class="token variable">`</span>g<span class="token variable">`</span></span> — 全局匹配，查找所有的匹配项
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">var</span> str2 <span class="token operator">=</span> <span class="token string">&quot;Today is fine day,today is fine day !!!&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str2<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;today&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;tomorrow&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//只能替换第一个today</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str2<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">today</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span> <span class="token string">&quot;tomorrow&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//这里用到了正则为“全局匹配”模式，才能替换所有的today</span>


<span class="token doc-comment comment">/** replace */</span>
<span class="token keyword">const</span> regExp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^([A-Za-z]+): (.*)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gu</span></span>
<span class="token string">&#39;first: Jane&#39;</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span>regExp<span class="token punctuation">,</span> <span class="token string">&#39;KEY: $1, VALUE: $2&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &#39;KEY: first, VALUE: Jane&#39;</span>


<span class="token doc-comment comment">/** replaceAll() 对插入命名组的捕获 */</span>
<span class="token keyword">const</span> regExp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(?&lt;key&gt;[A-Za-z]+): (?&lt;value&gt;.*)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gu</span></span>
<span class="token string">&#39;first: Jane&#39;</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span>regExp<span class="token punctuation">,</span> <span class="token string">&#39;KEY: $&lt;key&gt;, VALUE: $&lt;value&gt;&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &#39;KEY: first, VALUE: Jane&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="搜索search" tabindex="-1"><a class="header-anchor" href="#搜索search"><span>搜索<code>search()</code></span></a></h3><blockquote><ul><li><code>search()</code>：搜索字符串中是否含有指定内容，返回指定内容第一次出现的索引；否则返回-1（注意：search只会查找一个，即使设置全局匹配也无效）</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;hello abc hello aec afc&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 搜索字符串中是否含有abc 或 aec 或 afc</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a[bef]c</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	 <span class="token comment">// 6</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="提取match" tabindex="-1"><a class="header-anchor" href="#提取match"><span>提取<code>match()</code></span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 提取 match()</span>
- <span class="token variable"><span class="token variable">`</span>match<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span>：根据正则表达式从一个字符串中将符合条件的内容提取出来，封装到一个数组中返回。

注意：默认情况下，<span class="token variable"><span class="token variable">`</span>match<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> 方法只找到 <span class="token string">&#39;第一个&#39;</span> 符合要求的内容后就停止检索，但是设置正则表达式为 <span class="token string">&#39;全局匹配&#39;</span> 模式，就会匹配到所有相关的内容，并以 <span class="token string">&#39;数组&#39;</span> 的形式返回。



<span class="token comment">### 提取所有匹配项 matchAll()</span>
- ES2020 增加 <span class="token variable"><span class="token variable">`</span>String.prototype.matchAll<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> 方法，可以一次性提取所有匹配。不过，它返回的是一个遍历器<span class="token punctuation">(</span>Iterator<span class="token punctuation">)</span>，而不是数组。

- 由于 <span class="token variable"><span class="token variable">`</span>string.matchAll<span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token variable">`</span></span> 返回的是遍历器，所以可以用 <span class="token variable"><span class="token variable">`</span>for<span class="token punctuation">..</span>.of<span class="token variable">`</span></span> 循环取出。相对于返回数组，返回遍历器的好处在于，如果匹配结果是一个很大的数组，那么遍历器比较节省资源。
遍历器可以使用 <span class="token variable"><span class="token variable">`</span><span class="token punctuation">..</span>.<span class="token variable">`</span></span>运算符 和 <span class="token variable"><span class="token variable">`</span>Array.from<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> 方法来转为数组。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/** match() */</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;1aae6A8B&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> r1 <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[a-z]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 找到符合要求的第一个内容，然后返回</span>
<span class="token keyword">var</span> r2 <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[a-z]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 设置为“全局匹配”模式，匹配字符串中 所有的小写字母</span>
<span class="token keyword">var</span> r3 <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[a-z]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置多个匹配模式，匹配字符串中 所有的字母（忽略大小写）</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">,</span> r3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印结果：[&quot;a&quot;], [&quot;a&quot;, &quot;a&quot;, &quot;e&quot;], [&quot;a&quot;, &quot;a&quot;, &quot;e&quot;, &quot;A&quot;, &quot;B&quot;]</span>


<span class="token doc-comment comment">/** matchAll() */</span>
<span class="token keyword">const</span> string <span class="token operator">=</span> <span class="token string">&#39;test1test2test3&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// g 修饰符加不加都可以</span>
<span class="token keyword">const</span> regex <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">t(e)(st(\d?))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> match <span class="token keyword">of</span> string<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>match<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// [&quot;test1&quot;, &quot;e&quot;, &quot;st1&quot;, &quot;1&quot;, index: 0, input: &quot;test1test2test3&quot;]</span>
<span class="token comment">// [&quot;test2&quot;, &quot;e&quot;, &quot;st2&quot;, &quot;2&quot;, index: 5, input: &quot;test1test2test3&quot;]</span>
<span class="token comment">// [&quot;test3&quot;, &quot;e&quot;, &quot;st3&quot;, &quot;3&quot;, index: 10, input: &quot;test1test2test3&quot;]</span>


<span class="token comment">// 转为数组方法一</span>
<span class="token punctuation">[</span><span class="token operator">...</span>string<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment">// 转为数组方法二</span>
Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="拆分split" tabindex="-1"><a class="header-anchor" href="#拆分split"><span>拆分<code>split()</code></span></a></h3><blockquote><ul><li><code>split()</code> 可以使用字符串或正则表达式指定分隔符来进行拆分字符串成一个数组。 <ul><li>如果该正则表达式至少包含一个捕获组，则 <code>split()</code> 返回一个数组，其中子字符串与第一个组捕获的内容交错</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">&quot;11a22b33c44d55e66f77g&quot;</span>
<span class="token keyword">const</span> regExp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[A-z]</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">const</span> result <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>regExp<span class="token punctuation">)</span> <span class="token comment">// 参数是一个正则表达式：表示所有字母</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>  <span class="token comment">// [ &#39;11&#39;, &#39;22&#39;, &#39;33&#39;, &#39;44&#39;, &#39;55&#39;, &#39;66&#39;, &#39;77&#39;, &#39;&#39; ]</span>


<span class="token keyword">const</span> regExp1 <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;(-+)&gt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gu</span></span>
<span class="token keyword">const</span> str1 <span class="token operator">=</span> <span class="token string">&#39;a&lt;---&gt;b&lt;-&gt;c&#39;</span>
str1<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>regExp1<span class="token punctuation">)</span> <span class="token comment">// [ &#39;a&#39;, &#39;---&#39;, &#39;b&#39;, &#39;-&#39;, &#39;c&#39; ]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="regexp-prototype-exec" tabindex="-1"><a class="header-anchor" href="#regexp-prototype-exec"><span>RegExp.prototype.exec()</span></a></h3><blockquote><p>在以下示例中，我们收集数组匹配中组 1 的所有捕获：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">collectGroup1</span><span class="token punctuation">(</span><span class="token parameter">regExp<span class="token punctuation">,</span> str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> matches <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> match <span class="token operator">=</span> regExp<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>match <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">break</span>
    <span class="token comment">// 将组 1 的捕获添加到 matches</span>
    matches<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> matches
<span class="token punctuation">}</span>

<span class="token function">collectGroup1</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&quot;([^&quot;]*)&quot;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gu</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&quot;foo&quot; and &quot;bar&quot; and &quot;baz&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token comment">// [ &#39;foo&#39;, &#39;bar&#39;, &#39;baz&#39; ]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>没有标志 <code>/g</code>，<code>exec()</code> 始终只返回第一个匹配项：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[abc]</span><span class="token regex-delimiter">/</span></span>
re<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;abc&#39;</span><span class="token punctuation">)</span> <span class="token comment">// [ &#39;a&#39;, index: 0, input: &#39;abc&#39; ]</span>

re<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;abc&#39;</span><span class="token punctuation">)</span> <span class="token comment">// [ &#39;a&#39;, index: 0, input: &#39;abc&#39; ]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这对 <code>collectGroup1()</code> 来说是个坏消息，因为如果 <code>regExp</code> 没有标志 <code>/g</code>，它将永远不会完成。</p></blockquote><h3 id="常规正则" tabindex="-1"><a class="header-anchor" href="#常规正则"><span>常规正则</span></a></h3><h4 id="匹配是否包含汉字" tabindex="-1"><a class="header-anchor" href="#匹配是否包含汉字"><span>匹配是否包含汉字</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/** 传统的匹配是否包含汉字：枚举法 */</span>
<span class="token keyword">const</span> pattern1 <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\u4E00-\u9FCC\u3400-\u4DB5\uFA0E\uFA0F\uFA11\uFA13\uFA14\uFA1F\uFA21\uFA23\uFA24\uFA27-\uFA29]|[\uD840-\uD868][\uDC00-\uDFFF]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|[\uD86A-\uD86C][\uDC00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D]</span><span class="token regex-delimiter">/</span></span>


<span class="token doc-comment comment">/** 优化后的匹配汉字表达式 */</span>
<span class="token keyword">const</span> pattern <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\p{Script=Han}</span><span class="token regex-delimiter">/</span><span class="token regex-flags">u</span></span>
<span class="token operator">!</span><span class="token operator">!</span><span class="token string">&#39;你好&#39;</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span> <span class="token comment">// true</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="数据结构" tabindex="-1"><a class="header-anchor" href="#数据结构"><span>数据结构</span></a></h2><h3 id="set" tabindex="-1"><a class="header-anchor" href="#set"><span>Set</span></a></h3><blockquote><ul><li><code>Set</code>数据结构类似于数组，但成员值都是唯一、没有重复的值（可用于<strong>搜索关键词、数组去重</strong>）</li><li><code>Set</code>本身是构造函数，用来生成<code>Set</code>数据结构，<code>Set</code>函数可以接受一个数组(或具有Iterable接口的其他数据结构)作为参数，用来初始化</li><li>注意：在Set内部两个<code>NaN</code>是相等的，两个对象总是不相等的</li><li>实例方法 <ul><li><code>add(value)</code>：增加新元素，返回Set结构本身</li><li><code>delete(value)</code>：删除指定元素，返回布尔值表示是否删除成功</li><li><code>has(value)</code>：返回布尔值，检测Set数据是否有该值</li><li><code>size()</code>：返回集合的元素个数</li><li><code>clear()</code>：清除所有成员，没有返回值</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
s<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// s：{1, 2}</span>
s<span class="token punctuation">.</span>size	<span class="token comment">// 2</span>
s<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>	<span class="token comment">// s: {1}</span>
s<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>	<span class="token comment">// false</span>

<span class="token keyword">const</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	{1, 2, 3, 4}</span>
<span class="token keyword">const</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	{&quot;a&quot;, &quot;b&quot;}</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>set<span class="token punctuation">]</span><span class="token punctuation">;</span>	<span class="token comment">//把set结构转换为数组结构 [ &#39;a&#39;, &#39;b&#39; ]</span>

<span class="token comment">//遍历set数据结构</span>
set<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>	<span class="token comment">//a b</span>

<span class="token comment">/* 遍历器：只能用for of来遍历 */</span>
<span class="token comment">// Array.keys()指的是返回键名的遍历器</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> s <span class="token keyword">of</span> arr<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0 1</span>
<span class="token punctuation">}</span>
<span class="token comment">//.values()指的是返回键值的遍历器</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token keyword">of</span> arr<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a b</span>
<span class="token punctuation">}</span>
<span class="token comment">//.entries()指的是返回键值对的遍历器</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> y <span class="token keyword">of</span> arr<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 0, &#39;a&#39; ] [ 1, &#39;b&#39; ]</span>
<span class="token punctuation">}</span>

<span class="token comment">/* map 和 filter方法可间接用于Set */</span>
<span class="token keyword">let</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>set<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> val <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>set<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>val <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">let</span> set1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> set2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 模拟求交集 </span>
<span class="token keyword">let</span> intersection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>set1<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> set2<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 模拟求差集</span>
<span class="token keyword">let</span> difference <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>set1<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>set2<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Set集合与数组互换</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>set1<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> mySet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>

<span class="token comment">// 数组去重</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;meili&quot;</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> m  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span>stringify<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span>parse<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>	<span class="token comment">// [ 123, [ 1, 2, 3 ], [ 1, &#39;2&#39;, 3 ], &#39;meili&#39; ]</span>

<span class="token comment">// 去除数组重复成员</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment">// 去除字符串的重复字符</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token string">&#39;ababbc&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="weakset" tabindex="-1"><a class="header-anchor" href="#weakset"><span>WeakSet</span></a></h3><blockquote><ul><li><code>WeakSet</code>与<code>Set</code>结构的区别 <ul><li><code>WeakSet</code>成员只能是对象，而不能有其他类型的值（可接受数组或类似数组的对象作为参数）</li><li><code>WeakSet</code>中的对象都是弱引用（即当其他对象不再引用该对象时，垃圾回收机制会自动回收该对象所占用的内存，使得我们不用考虑对象还存不存在<code>WeakSet</code>中），常用于保存DOM节点使得不容易造成内存泄漏</li><li>总结：所以WeakSet的成员是不适合引用的，因为它会随时消失。由于内部成员数量取决于垃圾回收机制是否运行，运行前后很可能成员数量不同，且垃圾回收机制何时运行不可测，所以ES6规定WeakSet不可遍历</li></ul></li><li><code>ws.add(val)</code>：向 WeakSet 实例添加一个新成员</li><li><code>ws.delete(val)</code>：清除 WeakSet 实例的指定成员</li><li><code>ws.has(val)</code>：返回一个布尔值，表示某个值是否在 WeakSet 实例之中</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// WeakSet {[1, 2], [3, 4]}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
ws<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
ws<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>	<span class="token comment">// true</span>
ws<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="map" tabindex="-1"><a class="header-anchor" href="#map"><span>Map</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## Map 数据结构</span>
- <span class="token variable"><span class="token variable">`</span>Map<span class="token variable">`</span></span> 数据结构是为了**解决对象无法使用非字符串作为键**而提出的数据结构（即Map可使用各种类型的值作为键，包括对象也可作为键）
- <span class="token variable"><span class="token variable">`</span>Map<span class="token variable">`</span></span>本质上是一个二维数组，其中数组元素是只包含两个元素<span class="token punctuation">(</span>键值对<span class="token punctuation">)</span>的数组。

    - 设置键值对：<span class="token variable"><span class="token variable">`</span>set<span class="token punctuation">(</span>key, value<span class="token punctuation">)</span><span class="token variable">`</span></span>
    - 获得值：<span class="token variable"><span class="token variable">`</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token variable">`</span></span>
    - 删除键值对：<span class="token variable"><span class="token variable">`</span>delete<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token variable">`</span></span>
    - 清空所有数据：<span class="token variable"><span class="token variable">`</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span>

    - 构造Map实例 <span class="token variable"><span class="token variable">`</span>new Map<span class="token punctuation">(</span>iterable<span class="token punctuation">)</span><span class="token variable">`</span></span> 参数是 <span class="token variable"><span class="token variable">`</span>iterable<span class="token variable">`</span></span> 对象。
    - 由于 <span class="token variable"><span class="token variable">`</span>entries<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> 方法产生的形式与 Map 本身一样，所以可以用 Map实例当参数传入
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * 一般使用
 */</span>
<span class="token keyword">const</span> map1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> map2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>map1<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 等价 let m3 = new Map(map1);</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map2<span class="token punctuation">)</span>

<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
map1<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">&#39;foo&#39;</span><span class="token punctuation">)</span>
map1<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token string">&#39;bar&#39;</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map1<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map1<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false true</span>

<span class="token keyword">const</span> marr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>map1<span class="token punctuation">]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>marr<span class="token punctuation">)</span> <span class="token comment">// [[{id: 1}, &#39;foo&#39;], [{id: 2}, &#39;bar&#39;]]; 二维数组</span>

<span class="token keyword">const</span> marr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>map1<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment">// 效果同上 [...map1]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>marr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// &#39;foo&#39;</span>



<span class="token doc-comment comment">/**
 * 迭代遍历
 */</span>
<span class="token keyword">const</span> map3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">&#39;acc&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;abcd&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&#39;123&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token string">&#39;手机&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token string">&#39;电脑&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&#39;2 &gt; 3&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;不正确&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map3<span class="token punctuation">)</span> <span class="token comment">// Map { &#39;acc&#39; =&gt; &#39;abcd&#39;, 123 =&gt; { x: &#39;手机&#39;, y: &#39;电脑&#39; }, false =&gt; &#39;不正确&#39; }</span>

<span class="token comment">// 可以直接使用数组的foreach遍历</span>
map3<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 遍历器</span>
<span class="token comment">// 遍历器只能用for of来遍历</span>
<span class="token comment">// .keys()指的是返回键名的遍历器</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> s <span class="token keyword">of</span> map3<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// .values()指的是返回键值的遍历器</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> a <span class="token keyword">of</span> map3<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// .entries()指的是返回键值对的遍历器</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> y <span class="token keyword">of</span> map3<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="map和-object-的区别" tabindex="-1"><a class="header-anchor" href="#map和-object-的区别"><span>Map和 Object 的区别</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">### Map 和 Object 的区别</span>
<span class="token number">1</span>. Key 的类型：
对象（Object）的键必须是字符串或者Symbols。尽管当你使用非字符串作为键时，它会被转换为字符串。
Map可以使用任何类型作为键，包括对象、函数、原始类型。

<span class="token number">2</span>. 键的顺序：
对象（Object）在ES2015之前没有键的顺序保证；而在ES2015及之后，字符串键按照创建时的顺序排列，Symbol键则按照它们被添加到对象的顺序排列。
Map则会按照元素添加的顺序保持键值对的顺序。

<span class="token number">3</span>. 大小可追踪：
对象（Object）没有内建的方式来追踪有多少键值对存在。
Map有一个size属性，可以直接获取到Map中键值对的数量。

<span class="token number">4</span>. 性能：
对象（Object）在处理大量的键值对和频繁添加和删除键值对时，性能可能不如Map。
Map在频繁的添加和删除键值对的操作中通常提供更好的性能，特别是当涉及到大量的键值对时。

<span class="token number">5</span>. 易用性：
对象（Object）拥有字面量语法（<span class="token punctuation">{</span><span class="token punctuation">}</span>），并且在JavaScript中被广泛使用。
Map则需要使用构造函数（new Map<span class="token punctuation">(</span><span class="token punctuation">)</span>）来创建。

<span class="token number">6</span>. 内建方法：
对象（Object）有一些内建的原型方法，但这些方法可能被对象的键覆盖。
Map提供了一套标准的方法来操作数据，例如get<span class="token punctuation">(</span><span class="token punctuation">)</span>, set<span class="token punctuation">(</span><span class="token punctuation">)</span>, has<span class="token punctuation">(</span><span class="token punctuation">)</span>, delete<span class="token punctuation">(</span><span class="token punctuation">)</span>, clear<span class="token punctuation">(</span><span class="token punctuation">)</span>，以及可以直接进行迭代的方法，例如keys<span class="token punctuation">(</span><span class="token punctuation">)</span>, values<span class="token punctuation">(</span><span class="token punctuation">)</span>, 和 entries<span class="token punctuation">(</span><span class="token punctuation">)</span>。

<span class="token number">7</span>. JSON支持：
对象（Object）可以直接被转换为JSON字符串，使用JSON.stringify<span class="token punctuation">(</span><span class="token punctuation">)</span>。
Map不支持直接转换为JSON，需要先转换为数组或者其他结构。

在实践中：
如果你需要保证键的顺序，或者你的键不仅仅是字符串或Symbol，那么Map可能是更好的选择。
如果你的数据结构相对简单，并且主要用于JSON序列化，那么对象可能更便捷。

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="weakmap" tabindex="-1"><a class="header-anchor" href="#weakmap"><span>WeakMap</span></a></h3><blockquote><ul><li><p><code>WeakMap</code>是为了**解决频繁变动对象垃圾回收（GC）**而引入的Map弱引用数据结构。</p></li><li><p><code>WeakMap</code>只接受对象作为键名(null 除外)。当对象只被<code>WeakMap</code>引用到而没被其他对象引用时，则会被垃圾回收机制回收并释放内存，相应的<code>WeakMap</code>这一键值对会被删除。</p><ul><li>即把键重定义为<code>null</code>，会清除之前键的引用，可以释放该出的内存； 把值定义为<code>null</code>，只是清除值的引用，而键还在，所以不会被垃圾回收。</li></ul></li><li><p>键名是弱引用，键值可以是任意的，键名所指向的对象可以被垃圾回收，此时键名是无效的</p></li><li><p>不能遍历，方法有 get、set、has、delete</p></li><li><p>（WeakMap的特点很适合给DOM对象关联一些信息存储在<code>WeakMap</code>中，DOM对象一旦被删除，则其内存会被回收，WeakMap的这一键值对会消失）</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> w <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
m<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
m<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// {id: 1}不再由变量x引用，只有m才能引用，此时，{id: 1}会被垃圾回收，这一键值对会被删除；</span>
w <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 尽管值{id: 4}也不再由w引用，但m对值的引用是强引用，所以{id: 4}不会被回收</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * 使用DOM节点作为键名
 * 每当发生click，就更新状态，并把这个状态作为键值放在WeakMap，对应键名就是这个节点对象
 * 一旦这个DOM节点删除，该状态就会消失，不存在内存泄漏风险
 */</span>
<span class="token keyword">let</span> weakMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;logo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">timesClicked</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;logo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> logoData <span class="token operator">=</span> weakMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;logo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  logoData<span class="token punctuation">.</span>timesClicked<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token doc-comment comment">/**
 * 使用WeakMap 部署私有属性
 */</span>
<span class="token keyword">const</span> _counter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> _action <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Countdown</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">counter<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _counter<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _action<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> counter <span class="token operator">=</span> _counter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>counter <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    counter<span class="token operator">--</span><span class="token punctuation">;</span>
    _counter<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>counter <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _action<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 当counter为0时，则执行action函数</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Countdown</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;DONE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span><span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span><span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// DONE</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></blockquote><h3 id="weakref" tabindex="-1"><a class="header-anchor" href="#weakref"><span>WeakRef</span></a></h3><blockquote><ul><li>WeakRef对象用于直接创建对象的弱引用，基于原始对象创建的WeakRef实例不会妨碍原始对象被垃圾回收机制清除</li><li><code>wr.deref()</code>方法可判断原始对象是否已被垃圾回收清除</li><li>弱引用对象的用处是：作为缓存，未被清除时可以从缓存中取值，一旦清除缓存就自动失效</li><li>注意：一旦使用<code>WeakRef()</code>创建了原始对象的弱引用，则在本轮事件循环<code>event loop</code>中，原始对象肯定不会被清除，只会在后面的事件循环才会被清除</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * target是原始對象
 * 构造函数 WeakRef() 创建了一个基于 target的新对象wr
 * wr属于对target的弱引用，不会被垃圾回收机制计入这个引用
 * 即wr的引用不会妨碍原始对象target被垃圾回收机制清除
*/</span>
<span class="token keyword">let</span> targe <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> wr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakRef</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// wr 和 target 是不一样的</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> wr<span class="token punctuation">.</span><span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// target 未被垃圾回收机制清除</span>
  <span class="token comment">/* .... */</span>
<span class="token punctuation">}</span>


<span class="token doc-comment comment">/**
 * @ makeWeakCached() 用于建立一个缓存，缓存里面保存对原始文件的弱引用
 */</span>
<span class="token keyword">function</span> <span class="token function">makeWeakCached</span><span class="token punctuation">(</span><span class="token parameter">files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ref <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ref<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> cached <span class="token operator">=</span> ref<span class="token punctuation">.</span><span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cached <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token keyword">return</span> cached<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> fresh <span class="token operator">=</span> <span class="token function">files</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span>fresh<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> fresh<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> getImageCached <span class="token operator">=</span> <span class="token function">makeWeakCached</span><span class="token punctuation">(</span>getImage<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="finalizationregistry" tabindex="-1"><a class="header-anchor" href="#finalizationregistry"><span>FinalizationRegistry</span></a></h3><blockquote><ul><li>清理器注册表功能<code>FinalizationRegistry</code>用来指定目标对象被垃圾回收机制清除后，所要执行的回调函数</li><li>注意：注册表不对目标对象构成强引用，属于弱引用。因为强引用的话，原始对象就不会被垃圾回收机制清除，这就失去使用注册表的意义</li><li>回调函数的参数<code>heldValue</code>可以是任意类型的值，字符串、数值、布尔值、对象，甚至可以是<code>undefined</code></li><li>若想取消已经注册的回调函数，则要向<code>register()</code>传入第三个参数，作为标记值，这个标记值必须是对象，一般都用原始对象。然后再使用注册表实例对象的<code>unregister()</code>方法取消注册。 <ul><li>第三个参数也属于弱引用，如果没有这个参数，则回调函数无法取消</li><li>由于回调函数被调用以后就不再存在于注册表之中，所以执行<code>unregister()</code>应该是在回调函数还没被调用之前。</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * 新建一个注册表实例
 * @FinalizationRegistry 是系统提供的构造函数；
 * <span class="token keyword">@callBack</span> 回调函数作为该构造函数参数传入，它本身有一个参数 heldValue
 * <span class="token keyword">@return</span> 返回一个清理器注册表实例，里面登记了索要执行的回调函数
*/</span>
<span class="token keyword">const</span> registry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FinalizationRegistry</span><span class="token punctuation">(</span><span class="token parameter">heldValue</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ....</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@registry</span> 注册表实例的registry 方法，来用注册索要观察的目标对象
 * theObject是索要观察的目标对象，一旦该对象被垃圾回收机制清除，注册表就会在清除完成后，调用早前注册表的回调函数，并将`some value`作为参数传入回调函数
*/</span>
registry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>theObject<span class="token punctuation">,</span> <span class="token string">&quot;some value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 第三个参数用于取消已注册的回调函数</span>
registry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>theObject<span class="token punctuation">,</span> <span class="token string">&quot;some value&quot;</span><span class="token punctuation">,</span> theObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...其他操作</span>

<span class="token comment">// ...过了一段时间，如果你不再关心 theObject</span>
registry<span class="token punctuation">.</span><span class="token function">unregister</span><span class="token punctuation">(</span>theObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="【典例】缓存函数" tabindex="-1"><a class="header-anchor" href="#【典例】缓存函数"><span>【典例】缓存函数</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * 缓存函数
 * 增加一个清理器注册表，一旦缓存的原始对象被垃圾回收机制清除，会自动执行一个回调函数
 * 该回调函数会清除缓存里面已经失效的键
*/</span>
<span class="token keyword">function</span> <span class="token function">makeWeakCached</span><span class="token punctuation">(</span><span class="token parameter">files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> cleanup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FinalizationRegistry</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ref <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ref <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>ref<span class="token punctuation">.</span><span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> cached<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ref <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ref<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> cached <span class="token operator">=</span> ref<span class="token punctuation">.</span><span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cached <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token keyword">return</span> cached<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> fresh <span class="token operator">=</span> <span class="token function">files</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span>fresh<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cleanup<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>fresh<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> fresh<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> getImageCached <span class="token operator">=</span> <span class="token function">makeWeakCached</span><span class="token punctuation">(</span>getImage<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h2 id="高阶函数" tabindex="-1"><a class="header-anchor" href="#高阶函数"><span>高阶函数</span></a></h2><ul><li>高阶函数是对其他函数进行操作的函数，它接受函数作为参数或将函数作为返回值输出。</li><li>函数也是一种数据类型，可作为参数传递给另一个参数使用。如：回调函数。</li></ul><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span><span class="token property">background-color</span><span class="token punctuation">:</span> pink<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../lib/jquery-3.2.1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
function fn(a, b, callback) {
    console.log(a + b);
    callback &amp;&amp; callback();
}
fn(1, 2, function() {
    console.log(&quot;我是最后调用的&quot;);
});
$(&quot;div&quot;).animate({left: 500}, function(){
    $(&quot;div&quot;).css(&quot;background&quot;,&quot;purple&quot;);
})
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="generator生成器" tabindex="-1"><a class="header-anchor" href="#generator生成器"><span><code>generator</code>生成器</span></a></h3><ul><li>generator 生成器是ES6引入的新数据类型，<strong>可返回多次值</strong>。</li><li>generator 与一般函数的区别 <ul><li>一般函数在执行过程中，如果没有遇到<code>return </code>语句(函数末尾如果没有<code>return</code>，默认为<code>return undefined;</code>)，控制权无法返回被调用的代码。</li><li>generator与一般函数不同的是，generator由<code>function*</code>定义，并且除了<code>return</code>语句，还可用<code>yield</code>返回多次。</li></ul></li><li><code>yield*</code>表达式用于委托给另一个generator或可迭代对象。其表达式本身的值是当迭代器关闭时返回值(即done为true时)</li><li>调用一个生成器函数并不会马上执行它里面的语句，而是返回一个这个生成器的迭代器对象，当这个迭代器的<code>next()</code> 方法被调用时，其内的语句会执行到出现 <code>yield</code> 的位置为止（让执行处于<strong>暂停状态</strong>），<code>yield</code> 后紧跟迭代器要返回的值。或者如果用的是 <code>yield*</code>，则表示将执行权移交给另一个生成器函数（当前生成器<strong>暂停执行</strong>），调用 <code>next()</code>方法时如果传入参数，则此参数会作为<strong>上一条执行的 <code>yield</code> 语句的返回值</strong></li><li>调用 generator 对象由两个方法： <ol><li>不断地调用generator对象的<code>next()</code>方法。 <code>next()</code>方法会执行generator的代码，然后每次遇到<code>yield x;</code>就返回一个对象<code>{value:x, done:true/false}</code>，然后“暂停”。返回的<code>value</code>就是<code>yield</code>的返回值，<code>done</code>表示这个generator是否已经执行结束；如果<code>done</code>为<code>true</code>，则<code>value</code>就是<code>return</code>的返回值。</li><li>用<code>for...of</code>循环迭代 generator 对象，这种方式不需要判断<code>done</code></li></ol></li><li>generator应用场景 <ol><li>每次返回一个值：在同一场合下，函数只能返回一次，所以必须返回一个<code>Array</code>；但是换成generator，就<strong>可以一次返回一个数，不断返回多次</strong>。</li><li>用一个对象来保存状态：因为generator可以在执行过程中多次返回，所以它就像一个可记住执行状态的函数。</li><li>可把ajax的异步回调变成同步式ajax，相对传统的 then式，优化了回调地狱</li></ol></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">another</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token string">&#39;willy&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">another</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token string">&#39;hello&#39;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">yield</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> b<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">&quot;return&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> g <span class="token operator">=</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span>
  a <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token comment">// another()中返回的值</span>
  b <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token comment">// </span>
  c <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">&#39;world&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token comment">// 把语句 yield a+1 中的值</span>
  d <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">&#39;!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span>  <span class="token comment">// 把语句 yield b 中的值替换为 ! </span>
  e <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token comment">// return返回的值</span>
  f <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment">// 超出界限</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// [ &#39;willy&#39;, &#39;hello&#39;, &#39;world1&#39;, &#39;!&#39;, &#39;return&#39;, undefined ]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">/* 普通函数 */</span>
<span class="token keyword">function</span> <span class="token function">fib</span><span class="token punctuation">(</span><span class="token parameter">max</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> max<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> a <span class="token operator">+</span> b<span class="token punctuation">]</span><span class="token punctuation">;</span>
    arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> arr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fib</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// [ 0, 1, 1, 2, 3 ]</span>

<span class="token comment">/* 生成器 */</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">fibGenerator</span><span class="token punctuation">(</span><span class="token parameter">max</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> max<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> a<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> a <span class="token operator">+</span> b<span class="token punctuation">]</span><span class="token punctuation">;</span>
    n<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token string">&#39;最后return的值&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// next()方法循环迭代generator</span>
<span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token function">fibGenerator</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> f1 <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> f2 <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> f3 <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token keyword">let</span> f4 <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> f5 <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> f6 <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;next()&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">,</span> f3<span class="token punctuation">,</span> f4<span class="token punctuation">,</span> f5<span class="token punctuation">,</span> f6<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// next() [ 0, 1, 1, 2, 3, &#39;最后return的值&#39; ]</span>

<span class="token comment">// for...of 循环迭代generator</span>
<span class="token keyword">let</span> ff <span class="token operator">=</span> <span class="token function">fibGenerator</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ffResult <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token keyword">of</span> ff<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(x);</span>
  ffResult <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>ffResult<span class="token punctuation">,</span> x<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;for...of：&quot;</span><span class="token punctuation">,</span> ffResult<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// for...of： [ 0, 1, 1, 2, 3 ]</span>


<span class="token comment">// while 循环迭代generator</span>
<span class="token keyword">let</span> fff <span class="token operator">=</span> <span class="token function">fibGenerator</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> fff<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>result<span class="token punctuation">,</span> res<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">;</span>
  res <span class="token operator">=</span> fff<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;while&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// while [ 0, 1, 1, 2, 3 ]</span>


<span class="token comment">// 用generator 生成同步式ajax，相对传统的 then，优化了回调地狱</span>
<span class="token comment">/* try {
  r1 = yield ajax(&#39;http://url-1&#39;, data1);
  r2 = yield ajax(&#39;http://url-2&#39;, data2);
  r3 = yield ajax(&#39;http://url-3&#39;, data3);
  success(r3);
} catch (err) {
  handle(err);
} */</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="iterator迭代器" tabindex="-1"><a class="header-anchor" href="#iterator迭代器"><span><code>Iterator</code>迭代器</span></a></h3><ul><li><code>String、Array、TypeArray、Map、Set</code>都是内置可迭代对象，因为它们原型对象都拥有<code>Symbol.iterator</code>方法。</li><li>用于可迭代对象的语法：<code>for..of</code>循环、展开语法(三点)、<code>yield*(生成器的yield多次返回值)</code>和解构对象。</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">/* Array */</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;b&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr1 <span class="token operator">=</span> arr<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr1<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> arr1<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> arr1<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> arr1<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* Map数据机构 */</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;willy&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;c&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cilly&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// 通过 for...of 循环迭代</span>
<span class="token keyword">const</span> iterator1 <span class="token operator">=</span> map<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> iterator1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;for..of循环迭代：&quot;</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 通过展开语法 三点运算符 来迭代</span>
<span class="token keyword">const</span> iterator2 <span class="token operator">=</span> map<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">...</span>iterator2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过生成器 yield* 多次返回来迭代</span>
<span class="token keyword">const</span> iterator3 <span class="token operator">=</span> map<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span><span class="token operator">*</span> iterator3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* 控制台输出
a b c undefined
for..of循环迭代：a,willy
for..of循环迭代：c,cilly
[ &#39;a&#39;, &#39;willy&#39; ] [ &#39;c&#39;, &#39;cilly&#39; ]
{ value: [ &#39;a&#39;, &#39;willy&#39; ], done: false } { value: [ &#39;c&#39;, &#39;cilly&#39; ], done: false } { value: undefined, done: true } */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="象征属性-symbol" tabindex="-1"><a class="header-anchor" href="#象征属性-symbol"><span>象征属性 Symbol</span></a></h2><ul><li><p>特点</p><ul><li><p>Symbol属性值唯一，避免了常量值重复问题</p></li><li><p>Symbol不能与其他类型的值进行运算</p></li><li><p>Symbol可以转换为字符串和布尔值，但不能转为数字</p></li><li><p>for in、for of 遍历时不会遍历Symbol属性。</p></li><li><blockquote><p>注意：Symbol是函数，但并不是构造函数</p></blockquote></li></ul></li><li><p><strong>symbol</strong> 是一种基本数据类型。<code>Symbol()</code>函数会返回<strong>symbol</strong>类型的值，该类型具有静态属性和静态方法。它的静态属性会暴露几个内建的成员对象；它的静态方法会暴露全局的symbol注册，且类似于内建对象类，但作为构造函数来说它并不完整，因为它不支持语法：&quot;<code>new Symbol()</code>&quot;。</p></li><li><p>每个从<code>Symbol()</code>返回的symbol值都是唯一的。一个symbol值能作为对象属性的标识符(该数据类型仅有的目的)。</p></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1 <span class="token operator">==</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> s2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="避免值重复" tabindex="-1"><a class="header-anchor" href="#避免值重复"><span>避免值重复</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token constant">KEY</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">alibaba</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">baidu</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">tencent</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">KEY</span><span class="token punctuation">.</span>alibaba<span class="token operator">:</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;alibaba&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token constant">KEY</span><span class="token punctuation">.</span>baidu<span class="token operator">:</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;baidu&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token constant">KYEY</span><span class="token punctuation">.</span>tencent<span class="token operator">:</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;tencent&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">getValue</span><span class="token punctuation">(</span><span class="token constant">KEY</span><span class="token punctuation">.</span>baidu<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实例-消除魔术字符串" tabindex="-1"><a class="header-anchor" href="#实例-消除魔术字符串"><span>实例：消除魔术字符串</span></a></h4><p>魔术字符串是指在代码中多次出现，与代码形成强耦合的某一字符串或数值，不利于将来的修改和维护。 消除魔术字符串 常用的是方法是把他<strong>设置为一个变量</strong>。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> evening <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&#39;星期一&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 给常用的字符串 定义为变量</span>
<span class="token keyword">function</span> <span class="token function">getEating</span><span class="token punctuation">(</span><span class="token parameter">today<span class="token punctuation">,</span> option</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> food <span class="token operator">=</span> <span class="token string">&quot;tomato&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>today<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token literal-property property">evening</span><span class="token operator">:</span>
      food <span class="token operator">=</span> option<span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> food<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getEating</span><span class="token punctuation">(</span>evening<span class="token punctuation">,</span> <span class="token string">&quot;noodles&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="可迭代对象" tabindex="-1"><a class="header-anchor" href="#可迭代对象"><span>可迭代对象</span></a></h4><ul><li>拥有<code>Symbol.iterator</code>函数的对象被称为可迭代对象，即可以在对象中使用<code>for..of</code>循环</li><li><code>symbol</code>让对象的内部数据和用户数据井水不犯河水。由于<code>sysmbol</code>无法在 JSON 里表示，因此不用担心给 Express API 传入带有不合适的<code>Symbol.iterator</code>属性的数据。另外，对于那种混合了内置函数和用户数据的对象，可以用<code>symbol</code>来确保用户数据不会跟内置属性冲突。</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> fibonacci <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token operator">+</span>b<span class="token punctuation">,</span> a<span class="token punctuation">]</span>
      <span class="token keyword">yield</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Prints every Fibonacci number less than 100</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> x <span class="token keyword">of</span> fibonacci<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>a<span class="token punctuation">,</span> x<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">yield</span> keys<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">iterator</span><span class="token operator">:</span> <span class="token string">&#39;not a function&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>MyClass</code> 的实例是可迭代对象，可以遍历对象上面的属性。但是上面的类有个潜在的缺陷，假设有个恶意用户给 <code>MyClass</code> 构造函数传了一个带有<code>iterator</code>属性的对象。当在实例上使用<code>for/of</code>会抛出<code>TypeError: obj is not iterable</code>异常。可以看出传入对象的 <code>iterator</code>函数覆盖了类的 <code>iterator</code>属性。会产生类似原型污染的安全问题，无脑复制用户数据会对一些特殊属性，比如<code>__proto__</code>和<code>constructor</code>带来问题。</li></ul><h4 id="复用同一个symbol值for-keyfor" tabindex="-1"><a class="header-anchor" href="#复用同一个symbol值for-keyfor"><span>复用同一个Symbol值for/keyFor</span></a></h4><ul><li><p><strong><code>Symbol.for(key)</code></strong> 方法会根据给定的键 <code>key</code>来从运行时的 symbol 注册表中找到对应的 symbol，如果找到则返回它；否则，新建一个与该键关联的 symbol，并放入全局 symbol 注册表中。</p></li><li><p>**<code>Symbol.keyFor(key)</code>**方法返回一个已登记的 Symbol 类型值的<code>key</code>。</p></li><li><blockquote><p>注意：为了防范冲突，最好给要放入 symbol 注册表中的 symbol 带上键前缀。 for与keyfor的区别：前者会被登记在全局环境中供搜索，后者不会。</p></blockquote></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个 symbol 并放入 symbol 注册表中，键为 &quot;foo&quot;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从 symbol 注册表中读取键为&quot;foo&quot;的 symbol</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// true</span>
Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;mdn.foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 给加入键前缀 mdn.</span>

Symbol<span class="token punctuation">.</span><span class="token function">keyFor</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token comment">// &quot;foo&quot;</span>
Symbol<span class="token punctuation">.</span><span class="token function">keyFor</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="私有属性" tabindex="-1"><a class="header-anchor" href="#私有属性"><span>私有属性</span></a></h4><h4 id="实例-模块的-singleton-模式" tabindex="-1"><a class="header-anchor" href="#实例-模块的-singleton-模式"><span>实例：模块的 Singleton 模式</span></a></h4><p>Singleton模块指的是调用一个类，任何时候返回的都是同一个实例。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// a.js</span>
<span class="token keyword">const</span> <span class="token constant">NAME_KEY</span> <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 如果键名使用Symbol方法生成，那么外部将无法引用这个值，导致也就无法改写name的值。</span>
<span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;willy&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>global<span class="token punctuation">[</span><span class="token constant">NAME_KEY</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    global<span class="token punctuation">[</span><span class="token constant">NAME_KEY</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> global<span class="token punctuation">[</span><span class="token constant">NAME_KEY</span><span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token comment">// b.js</span>
global<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;xili&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>	<span class="token comment">// 调用时，更改a.js里面定义的name属性</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./a.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>	<span class="token comment">// { name: &#39;xili&#39; }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symbol-prototype-description" tabindex="-1"><a class="header-anchor" href="#symbol-prototype-description"><span>Symbol.prototype.description</span></a></h3><blockquote><p>当我们在 JS 中创建一个 <code>Symbol</code> 时，可以指定一个描述，用于以后的调试。取回这个描述的过程有点乏味。我们必须重新构造 <code>Symbol</code>，并借助 <code>toString()</code> 方法访问描述。</p><p>ES10 添加了一个名为 <code>description</code> 的新只读属性，该属性返回 <code>Symbol</code> 的描述。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> symbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&#39;This is a Symbol&#39;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>symbol<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Symbol(This is a Symbol)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>symbol<span class="token punctuation">.</span>description<span class="token punctuation">)</span> <span class="token comment">// This is a Symbol</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h2 id="代理对象-proxy" tabindex="-1"><a class="header-anchor" href="#代理对象-proxy"><span>代理对象 Proxy</span></a></h2><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 代理对象 Proxy</span>
- <span class="token variable"><span class="token variable">`</span>Proxy<span class="token variable">`</span></span>用于修改某些操作的默认行为，等同于在语言层里面做出修改，所以属于一种“元编程”，即对编程语言进行编程。
- Proxy给目标对象设置一层“拦截”，外界对该对象的访问必须通过这层拦截，可对外界的访问进行过滤和改写等自定义操作（代理完成对数据的处理、对构造函数的处理，对数据的验证）


<span class="token comment">## 反射 Reflect</span>
  - <span class="token variable"><span class="token variable">`</span>Reflect<span class="token variable">`</span></span>是一个内置对象，它提供拦截<span class="token variable"><span class="token variable">`</span>JavaScript<span class="token variable">`</span></span>操作的方法。这些方法与<span class="token variable"><span class="token variable">`</span>Proxy handlers<span class="token variable">`</span></span>的方法相同
  - <span class="token variable"><span class="token variable">`</span>Reflect<span class="token variable">`</span></span>不是一个函数对象，因此它是不可构造的，所以不能通过<span class="token variable"><span class="token variable">`</span>new<span class="token variable">`</span></span>来对其进行调用，或作为一个函数来调用。
  - <span class="token variable"><span class="token variable">`</span>Reflect<span class="token variable">`</span></span>的所有属性和方法都是静态的
  
  
  
 <span class="token builtin class-name">let</span> p <span class="token operator">=</span> new Proxy<span class="token punctuation">(</span>target, handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
	- 代理实例中没有指定的<span class="token variable"><span class="token variable">`</span>handler<span class="token variable">`</span></span>，实际就是操作原对象<span class="token variable"><span class="token variable">`</span>target<span class="token variable">`</span></span>。
	- <span class="token variable"><span class="token variable">`</span>target<span class="token variable">`</span></span>：需要使用<span class="token variable"><span class="token variable">`</span>Proxy<span class="token variable">`</span></span>包装的目标对象（可以是任何类型的对象，包括原生数组、函数、甚至是另一个代理）
	- <span class="token variable"><span class="token variable">`</span>handler<span class="token variable">`</span></span>：一个对象，其属性是当执行一个操作时定义代理的行为函数（可理解为某种触发器）  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
	* 同一拦截函数，设置拦截多个操作
*/</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> propKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>propKey <span class="token operator">===</span> <span class="token string">&#39;prototype&#39;</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>propKey <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token keyword">return</span> target<span class="token punctuation">[</span>propKey<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ReferenceError</span><span class="token punctuation">(</span><span class="token string">&quot;Prop name \&quot;&quot;</span> <span class="token operator">+</span> propKey <span class="token operator">+</span> <span class="token string">&quot;\&quot; does not exist.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">apply</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> thisBinding<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">construct</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> fproxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fproxy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token keyword">new</span> <span class="token class-name">fproxy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// {value: 2}</span>
fproxy<span class="token punctuation">.</span>prototype <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
froxy<span class="token punctuation">.</span>foo <span class="token operator">===</span> <span class="token string">&quot;foo&quot;</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="拦截方法" tabindex="-1"><a class="header-anchor" href="#拦截方法"><span>拦截方法</span></a></h4><ul><li><strong>get(target, propKey, receiver)</strong>：拦截对象属性的读取，比如<code>proxy.foo</code>和<code>proxy[&#39;foo&#39;]</code>。</li><li><strong>set(target, propKey, value, receiver)</strong>：拦截对象属性的设置，比如<code>proxy.foo = v</code>或<code>proxy[&#39;foo&#39;] = v</code>，返回一个布尔值。</li><li><strong>has(target, propKey)</strong>：拦截<code>propKey in proxy</code>的操作，返回一个布尔值。</li><li><strong>deleteProperty(target, propKey)</strong>：拦截<code>delete proxy[propKey]</code>的操作，返回一个布尔值。</li><li><strong>ownKeys(target)</strong>：拦截<code>Object.getOwnPropertyNames(proxy)</code>、<code>Object.getOwnPropertySymbols(proxy)</code>、<code>Object.keys(proxy)</code>、<code>for...in</code>循环，返回一个数组。该方法返回目标对象所有自身的属性的属性名，而<code>Object.keys()</code>的返回结果仅包括目标对象自身的可遍历属性。</li><li><strong>getOwnPropertyDescriptor(target, propKey)</strong>：拦截<code>Object.getOwnPropertyDescriptor(proxy, propKey)</code>，返回属性的描述对象。</li><li><strong>defineProperty(target, propKey, propDesc)</strong>：拦截<code>Object.defineProperty(proxy, propKey, propDesc）</code>、<code>Object.defineProperties(proxy, propDescs)</code>，返回一个布尔值。</li><li><strong>preventExtensions(target)</strong>：拦截<code>Object.preventExtensions(proxy)</code>，返回一个布尔值。</li><li><strong>getPrototypeOf(target)</strong>：拦截<code>Object.getPrototypeOf(proxy)</code>，返回一个对象。</li><li><strong>isExtensible(target)</strong>：拦截<code>Object.isExtensible(proxy)</code>，返回一个布尔值。</li><li><strong>setPrototypeOf(target, proto)</strong>：拦截<code>Object.setPrototypeOf(proxy, proto)</code>，返回一个布尔值。如果目标对象是函数，那么还有两种额外操作可以拦截。</li><li><strong>apply(target, object, args)</strong>：拦截 Proxy 实例作为函数调用的操作，比如<code>proxy(...args)</code>、<code>proxy.call(object, ...args)</code>、<code>proxy.apply(...)</code>。</li><li><strong>construct(target, args)</strong>：拦截 Proxy 实例作为构造函数调用的操作，比如<code>new proxy(...args)</code>。</li></ul></blockquote><h3 id="get" tabindex="-1"><a class="header-anchor" href="#get"><span>get()</span></a></h3><blockquote><ul><li><code>get(目标对象, 属性名, proxy实例本身[可选])</code>方法用于拦截某个属性的读取操作</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> propKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h2 id="承诺对象-promise" tabindex="-1"><a class="header-anchor" href="#承诺对象-promise"><span>承诺对象 Promise</span></a></h2><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 承诺对象 Promise</span>
- Promise 是异步编程的一种解决方案，表示 <span class="token string">&#39;承诺&#39;</span> 无法改变。
- 一般处理异步事件时，使用<span class="token variable"><span class="token variable">`</span>Promise<span class="token variable">`</span></span>对这个异步操作进行封装（如网络请求）
  - 封装一个网络请求函数，因不能立即拿到结果，所以往往会传入另一个函数，在数据请求成功时，将数据通过传入的函数回调出去（网络请求复杂，会耗时过长）
- new：构造函数（1.保存一些状态信息；2.执行传入的函数）



<span class="token comment">### Promise 的状态</span>
<span class="token number">1</span>. Promise 对象代表异步操作，有三种状态，且不受外界影响:
		- pending: 等待状态，在等响应跳转。
		- resolved/fulfilled: 满足状态，当我们主动回调resolve时处于该状态，并且会回调<span class="token variable"><span class="token variable">`</span>.then<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span>。
		- rejected: 拒绝状态，当我们主动回调了reject时处于该状态，并且会回调<span class="token variable"><span class="token variable">`</span>.catch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span>。
	注意：只有异步操作的结果，可以决定当前是哪一种状态，任何其他操作都无法改变这个状态。

<span class="token number">2</span>. 一旦状态改变，就不会再变，任何时候都可以得到这个结果<span class="token punctuation">(</span>不可逆<span class="token punctuation">)</span>
  Promise 对象的状态改变只有两种可能：从 Pending 变为 Resolved 和从 Pending 变为 Rejected。
  只要这两种情况发生，状态就凝固<span class="token punctuation">(</span>一直保持这个结果，不再改变<span class="token punctuation">)</span>。
  就算改变已经发生，再对 Promise 对象添加回调函数，也会立即得到这个结果。
  这与事件（Event）完全不同的是如果错过了该事件再去监听，是得不到结果的。



<span class="token comment">### Promise 优缺点</span>
- 优点：
		- 一旦状态改变，就不会再变，之后的任何时候都可以得到和这个结果。
		- Promise 对象提供统一的接口，可以将异步操作以同步操作的流程表达出来，避免了层层嵌套的回调函数<span class="token punctuation">(</span>解决了回调地狱问题<span class="token punctuation">)</span>
   
- 缺点：
   - 无法取消 Promise，一旦新建它就会立即执行，无法中途取消。
   - 如果不设置回调函数，Promise 内部抛出的错误，不会反应到外部。
   - 当处于 Pending 状态时，无法得知目前进展到哪一个阶段（刚刚开始还是即将完成）



<span class="token comment">### Promise 和 setTimeout 的区别</span>
Promise 是微任务，setTimeout 是宏任务，同一个事件循环中，promise.then总是先于 setTimeout 执行。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="promise创建" tabindex="-1"><a class="header-anchor" href="#promise创建"><span>Promise创建</span></a></h3><ul><li><p>当 new Promise()执行之后，promise 对象的状态会被初始化为<code>pending</code>状态。<code>new Promise()</code>括号里的内容是同步执行的。括号里可以再定义一个 异步任务的 function</p></li><li><p>Promise 构造函数包含一个参数和一个带有 resolve（解析）和 reject（拒绝）两个参数的回调。 在回调中执行一些操作（如异步），如果一切都正常，则调用 resolve，否则调用 reject。</p></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//在执行传入的回调函数时，会传入两个参数resolve, reject，本身又是函数</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>	<span class="token comment">// 立即回调</span>
  <span class="token comment">//执行成功后处理的代码 resolve处理</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//捕获抛出异常 reject处理</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="链式操作-then" tabindex="-1"><a class="header-anchor" href="#链式操作-then"><span>链式操作 then</span></a></h3><blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>res <span class="token operator">+</span> <span class="token string">&#39;111&#39;</span><span class="token punctuation">)</span>
  <span class="token comment">// return Promise.reject(&#39;error message（返回异常）&#39;);</span>
  <span class="token comment">// throw &quot;error message（抛出异常）&quot;;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>res <span class="token operator">+</span> <span class="token string">&#39;222&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 输出 a a111 a111222</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="长链式调用" tabindex="-1"><a class="header-anchor" href="#长链式调用"><span>长链式调用</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;Hello World&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res <span class="token operator">+</span> <span class="token string">&#39;start&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> res <span class="token operator">+</span> <span class="token string">&#39;111&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token keyword">return</span> res <span class="token operator">+</span> <span class="token string">&#39;222&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>res <span class="token operator">+</span> <span class="token string">&#39;error&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 此部分不执行，所以不输出</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token keyword">return</span> res <span class="token operator">+</span> <span class="token string">&#39;333&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token keyword">return</span> err <span class="token operator">+</span> <span class="token string">&#39;444&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res <span class="token operator">+</span> <span class="token string">&#39;end&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/* Hello Worldstart
Hello World111
Hello World111222
Hello World111222error
Hello World111222error444end */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="最终执行-finally" tabindex="-1"><a class="header-anchor" href="#最终执行-finally"><span>最终执行 finally</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 最终执行 Promise.prototype.finally()</span>
- finally<span class="token punctuation">(</span><span class="token punctuation">)</span> 方法无论 Promise 实例最终成功还是失败都会执行。
- finally<span class="token punctuation">(</span><span class="token punctuation">)</span> 函数不接受参数，finally 内部通常不知道 Promise 实例的执行结果，所以通常在 finally<span class="token punctuation">(</span><span class="token punctuation">)</span> 方法内执行的是与 Promise 状态无关的操作。
- 不管成功还是失败，都会走到finally中,并且finally之后，还可以继续then。并且会将值原封不动的传递给后面的then。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;res&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
promise
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fail&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;finally&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">/* 输出： success, res, finally */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="promise-prototype-finally-的实现" tabindex="-1"><a class="header-anchor" href="#promise-prototype-finally-的实现"><span><code>Promise.prototype.finally()</code> 的实现</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token class-name">Promise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">finally</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> value
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> err
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="promise-all" tabindex="-1"><a class="header-anchor" href="#promise-all"><span>Promise.all</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## Promise.all()</span>
<span class="token variable"><span class="token variable">`</span>Promsie.all<span class="token punctuation">(</span><span class="token punctuation">[</span>p1, p2, p3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token variable">`</span></span>：并发处理多个异步任务，所有任务都执行成功，才算成功（才会走到 then）；只要有一个任务失败，就会马上走到 catch，整体都算失败。
- 传递的参数是多个 promise 实例组成的数组。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;willy&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">11</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;william&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">22</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">results</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(results[0], results[1]);</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [{name: &#39;willy&#39;, age: 11}, {name: &#39;william&#39;, age: 22}]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="promise-all-的实现" tabindex="-1"><a class="header-anchor" href="#promise-all-的实现"><span>Promise.all() 的实现</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## Promise.all() 的实现</span>
<span class="token number">1</span>. 如果传入的参数是一个空的可迭代对象，那么此promise对象回调完成<span class="token punctuation">(</span>resolve<span class="token punctuation">)</span>，只有此情况，是同步执行的，其它都是异步返回的。
<span class="token number">2</span>. 如果传入的参数不包含任何 promise，则返回一个异步完成。 promises 中所有的promise都“完成”时或参数中不包含 promise 时回调完成。
<span class="token number">3</span>. 如果参数中有一个promise失败，那么Promise.all返回的promise对象失败。
<span class="token number">4</span>. 在任何情况下，Promise.all 返回的 promise 的完成状态的结果都是一个数组。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>Promise<span class="token punctuation">.</span><span class="token function-variable function">all</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>promises<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">function</span> <span class="token function">processValue</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>index <span class="token operator">===</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// promises[i] 可能是普通值</span>
        Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>promises<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">processValue</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="promise-race" tabindex="-1"><a class="header-anchor" href="#promise-race"><span>Promise.race</span></a></h3><ul><li><code>Promise.race([p1, p2, p3])</code>：并发处理多个异步任务，<strong>返回的是第一个执行完成的 promise</strong>，且状态和第一个完成的任务状态保持一致。参数里传的是多个 promise 实例组成的数组。</li><li>只要有一个异步任务执行完成，整体就是完成的</li><li>通常在http请求时，做超时判断时可以这样使用，设置一个定时器，当定时器时间到了时就在UI上提醒请求超时</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> promise1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">&#39;promise 1 resolved&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> promise2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>reject<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&#39;promise 2 rejected&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> promise3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&#39;promise 3 resolved&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>promise1<span class="token punctuation">,</span> promise2<span class="token punctuation">,</span> promise3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 输出- &quot;promise 2 rejected&quot;   </span>
<span class="token comment">// 尽管promise1和promise3可以解决，但promise2拒绝的速度比它们快。   </span>
<span class="token comment">// 因此Promise.race方法将以promise2拒绝</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;all&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;race&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*  all会输出，race不会输出 */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="promise-any-和-aggregateerror" tabindex="-1"><a class="header-anchor" href="#promise-any-和-aggregateerror"><span>Promise.any 和 AggregateError</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## Promise.any() 与 AggregateError</span>
- Promise.any<span class="token punctuation">(</span><span class="token punctuation">)</span> 接收一个 Promise 可迭代对象<span class="token punctuation">(</span>如数组<span class="token punctuation">)</span>，只要其中一个 Promise 成功，就返回那个已经成功的 Promise

- 如果传入的可迭代对象中的所有 Promise 都失败，将返回一个包含所有拒绝值的 <span class="token variable"><span class="token variable">`</span>AggregateError<span class="token variable">`</span></span> 实例。它是 Error 的一个子类，用于把单一的错误集合在一起。

- 只要一个成功就返回成功，如果所有的都失败才会报错；
- 如果 Promise.any 接收的是一个非 promise 数组，则返回成功。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> promise1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>reject<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&#39;promise 1 rejected&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> promise2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token string">&#39;promise 2 resolved at 400 ms&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> promise3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">,</span> <span class="token string">&#39;promise 3 resolved at 800 ms&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">[</span>promise1<span class="token punctuation">,</span> promise2<span class="token punctuation">,</span> promise3<span class="token punctuation">]</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//Output - &quot;promise 2 resolved at 400 ms&quot; </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 示例伪代码</span>
<span class="token comment">/* 返回成功的 */</span>
<span class="token keyword">const</span> promises1 <span class="token operator">=</span> <span class="token punctuation">[</span>
  Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&#39;ERROR A&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&#39;ERROR B&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;result&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

Promise<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span>promises1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;value: &#39;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;err: &#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 输出结果：value:  result</span>

<span class="token comment">/* 传入的所有Promises都失败 */</span>
<span class="token keyword">const</span> promises2 <span class="token operator">=</span> <span class="token punctuation">[</span>
  Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&#39;ERROR A&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&#39;ERROR B&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&#39;ERROR C&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
Promise<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span>promises2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;value：&#39;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;err：&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/* err：AggregateError: All promises were rejected
All promises were rejected
AggregateError
[&quot;ERROR A&quot;, &quot;ERROR B&quot;, &quot;ERROR C&quot;] */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="promise-all、race、any的区别" tabindex="-1"><a class="header-anchor" href="#promise-all、race、any的区别"><span>Promise.all、race、any的区别</span></a></h3><ul><li>Promise.any();有一个子实例成功就算成功，全部子实例失败才算失败；</li><li>Promise.all()；全部子实例的成功才算成功，一个子实例失败就算失败；</li><li>Promise.race()；rece是赛跑机制，看最先的promise子实例是成功还是失败。</li></ul><h3 id="promise-allsettled" tabindex="-1"><a class="header-anchor" href="#promise-allsettled"><span>Promise.allSettled</span></a></h3><blockquote><ul><li>当所有给定的 Promise 都得到解决时返回（<code>resolved</code> 或 <code>rejected</code>，无关紧要）。</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sm</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>sm<span class="token punctuation">)</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">err</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ms</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">sleep</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token punctuation">)</span>

Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>
Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>
Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">err</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>
Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">err</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="promise封装ajax" tabindex="-1"><a class="header-anchor" href="#promise封装ajax"><span>Promise封装Ajax</span></a></h3><blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">URL</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;GET&#39;</span><span class="token punctuation">,</span> <span class="token constant">URL</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    req<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 返回的还是一个 Promise对象，所以需要用then/catch</span>
<span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">&quot;./test.php&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&#39;内容是：&#39;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onRejected</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&#39;错误：&#39;</span> <span class="token operator">+</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="回调函数的缺点" tabindex="-1"><a class="header-anchor" href="#回调函数的缺点"><span>回调函数的缺点</span></a></h3><blockquote><ul><li>回调的写法比较直观，不需要 return，层层嵌套即可</li><li>如果多个异步函数存在依赖关系（需要等前一个异步函数执行完成后，才能执行下一个异步函数），就需要多个异步函数进⾏层层嵌套，会导致<strong>回调地狱</strong>的问题。</li></ul><h4 id="定时器的回调地狱" tabindex="-1"><a class="header-anchor" href="#定时器的回调地狱"><span>定时器的回调地狱</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;qiangu1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;qiangu2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;qiangu3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ajax-请求的回调地狱" tabindex="-1"><a class="header-anchor" href="#ajax-请求的回调地狱"><span>ajax 请求的回调地狱</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 伪代码</span>
<span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">&#39;a.json&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">&#39;b.json&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">&#39;c.json&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="回调的写法不一致问题" tabindex="-1"><a class="header-anchor" href="#回调的写法不一致问题"><span>回调的写法不一致问题</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// Node.js 读取文件时，成功回调和失败回调，是通过 error参数来区分</span>
<span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">&#39;d:\\readme.text&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;文件读取失败&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;文件读取成功&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// jQuery的 ajax 写法中，成功回调和失败回调，是通过两个回调函数来区分</span>
$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/ajax.json&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;文件读取成功&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;文件读取失败&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="捕获异常-try-catch" tabindex="-1"><a class="header-anchor" href="#捕获异常-try-catch"><span>捕获异常 <code>try/catch</code></span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 捕获异常 try...catch</span>
- try-catch 主要用于捕获 <span class="token string">&#39;同步函数&#39;</span> 的异常，无法捕获异步函数的异常
原因是当异步函数抛出异常时，
    - 对于宏任务而言，执行函数时已经将该函数推入栈，此时并不在 try-catch 所在的栈，所以 try-catch 并不能捕获到错误。
    - 对于微任务而言（如 Promise 的构造函数的异常只能被自带的 reject（.catch函数）捕获到）



<span class="token comment">### `promiseA().then().catch()` 和 `promiseA.catch().then()` 的区别</span>
		- 前者可以捕获到 <span class="token variable"><span class="token variable">`</span><span class="token keyword">then</span><span class="token variable">`</span></span> 里面的异常；
		- 后者不能捕获到 <span class="token variable"><span class="token variable">`</span><span class="token keyword">then</span><span class="token variable">`</span></span> 里面的异常。



<span class="token comment">### 可选 catch 绑定</span>
在 ES10 之前，语法迫使我们为 <span class="token variable"><span class="token variable">`</span>catch<span class="token variable">`</span></span> 子句绑定一个异常变量，不管它是否必要。
很多时候可以注意到，<span class="token variable"><span class="token variable">`</span>catch<span class="token variable">`</span></span> 块只是多余的。ES10 提案使我们能够完全忽略变量，让我们少关心一件事。
        try <span class="token punctuation">{</span>
          const data <span class="token operator">=</span> JSON.parse<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
          <span class="token builtin class-name">return</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span> catch <span class="token punctuation">{</span>
          <span class="token builtin class-name">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="异步函数-async-await" tabindex="-1"><a class="header-anchor" href="#异步函数-async-await"><span>异步函数 async/await</span></a></h3><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 异步函数 async/await</span>
- <span class="token variable"><span class="token variable">`</span>async/await<span class="token variable">`</span></span> 是 Generator 的语法糖，是一个自执行的 generate 函数。
		<span class="token variable"><span class="token variable">`</span>async <span class="token keyword">function</span><span class="token variable">`</span></span> 代替了 <span class="token variable"><span class="token variable">`</span><span class="token keyword">function</span> *<span class="token variable">`</span></span>，<span class="token variable"><span class="token variable">`</span>await<span class="token variable">`</span></span> 代替了 <span class="token variable"><span class="token variable">`</span>yield<span class="token variable">`</span></span>，同时也无需自己手写一个自动执行器 run。



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/** Generator */</span>
<span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res1 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./test.css&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">&#39;utf8&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> res2 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./json.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">&#39;utf8&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token doc-comment comment">/** async...await */</span>
<span class="token keyword">const</span> <span class="token function-variable function">readFile</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./test.css&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">&#39;utf8&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> res2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./json.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">&#39;utf8&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">&#39;done&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><ul><li><p><code>async</code>用于申明一个<code>function</code>是异步的，而<code>await</code>用于等待一个异步方法执行完成（<code>await</code>只出现在<code>async</code>函数中）</p></li><li><p><strong>async 函数会始终返回一个 Promise 对象</strong>。async 函数会把返回值通过 Promise.resolve() 封装成 Promise 对象再返回。</p></li><li><p>在函数内部没有 <code>await</code> 关键字的情况下执行 async 函数，函数会立即执行，但仍然返回一个已解决的 Promise，且绝不会阻塞后面的语句。这意味着即使没有 <code>await</code> 关键字，仍然可以使用 <code>.then</code> 和 <code>.catch</code> 来处理该函数产生的 Promise。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">Async</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;hello,async&quot;</span>
<span class="token punctuation">}</span>
<span class="token function">Async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// hello,async</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>await</code>是运算符，await 表达式的运算结果取决于它等的东西。如果它等到的是一个 Promise 对象，等 Promise 对象 resolve，然后得到 resolve 的值，作为 await 表达式的运算结果。async 函数调用不会造成阻塞，它内部所有的阻塞都被封装在一个 Promise 对象中异步执行。</p></li><li><p>单一的 Promise 链并不能发现 async/await 的优势，但如果需要处理由多个 Promise 组成的 then 链时，优势就能体现出来（Promise 通过 then 链来解决多层回调的问题，又用 async/await 来进一步优化它)</p></li><li><p><strong>例：假设一个业务，分多个步骤完成，每个步骤都是异步的，而且依赖于上一个步骤的结果</strong></p></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;假设一个业务，分多个步骤完成，每个步骤都是异步的，而且依赖于上一个步骤的结果&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">takeLongTime</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function-variable function">step1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">step1 with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>n<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">takeLongTime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function-variable function">step2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">step2 with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>m<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> and </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>n<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">takeLongTime</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function-variable function">step3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">k<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">step3 with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>k<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>m<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> and </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>n<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">takeLongTime</span><span class="token punctuation">(</span>k <span class="token operator">+</span> m <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* doIt = () =&gt; {
    console.time(&quot;Pormise .then()&quot;);
    const time1 = 300;
    step1(time1)
        .then(time2 =&gt; {
            return step2(time1, time2)
                .then(time3 =&gt; [time1, time2, time3]);
        })
        .then(times =&gt; {
            const [time1, time2, time3] = times;
            return step3(time1, time2, time3);
        })
        .then(result =&gt; {
            console.log(`Pormise .then() result is ${result}`);
            console.timeEnd(&#39;Pormise .then()&#39;);
        })
    
}
doIt(); */</span>
<span class="token comment">/* 输出 doIt()
step1 with 300
step2 with 300 and 500
step3 with 300, 500 and 500
Pormise .then() result is 1500
Pormise .then(): 1909.204ms */</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">&quot;async &amp;&amp; await&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> time1 <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> time2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">step1</span><span class="token punctuation">(</span>time1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> time3 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">step2</span><span class="token punctuation">(</span>time1<span class="token punctuation">,</span> time2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">step3</span><span class="token punctuation">(</span>time1<span class="token punctuation">,</span> time2<span class="token punctuation">,</span> time3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">async &amp;&amp; await result is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">async &amp;&amp; await</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* 输出 test()
step1 with 300
step2 with 300 and 500
step3 with 300, 500 and 500
async &amp;&amp; await result is 1500
async &amp;&amp; await: 1910.646ms */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="async-await-与-try-catch-结合使用" tabindex="-1"><a class="header-anchor" href="#async-await-与-try-catch-结合使用"><span>async/await 与 try/catch 结合使用</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// vue 中使用 async/await 与 try/catch 结合使用</span>
<span class="token keyword">async</span> <span class="token function-variable function">reqHttp</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  	<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">reqInterface</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> code<span class="token punctuation">,</span> total<span class="token punctuation">,</span> rows<span class="token punctuation">,</span> info <span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>code <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>rowData <span class="token operator">=</span> rows<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>total <span class="token operator">=</span> total<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;获取数据异常&quot;</span><span class="token punctuation">,</span> info<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;请求接口异常&quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="异步迭代器for-await-of" tabindex="-1"><a class="header-anchor" href="#异步迭代器for-await-of"><span>异步迭代器<code>for await...of</code></span></a></h4><blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 异步迭代器 for-await...of</span>
-  ES2018 引入异步迭代器（asynchronous iterators），这就像常规迭代器，除了<span class="token variable"><span class="token variable">`</span>next<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> 方法返回一个 Promise。因此 <span class="token variable"><span class="token variable">`</span>await<span class="token variable">`</span></span> 可以和 <span class="token variable"><span class="token variable">`</span>for<span class="token punctuation">..</span>.of<span class="token variable">`</span></span> 循环一起使用，以串行的方式运行异步操作。

- for-await<span class="token punctuation">..</span>.of 主要用于遍历异步可迭代对象。其会在异步或同步可迭代对象中创建一个迭代循环（String/Array/类数组/Map/Set/自定义可迭代对象）

- 注意1：for-await<span class="token punctuation">..</span>.of 语句只能在 async <span class="token keyword">function</span> 内使用。
- 注意2：如果是寻常的同步遍历方法进行循环，其执行顺序不会按顺序执行。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Gen</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/** 正确代码示例 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">Gen</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Gen</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Gen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// 输出：2000, 100, 3000</span>


<span class="token doc-comment comment">/** 正确代码示例：for-await...of 的实现原理 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">Gen</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Gen</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Gen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> i
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
<span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// 输出：100, 2000, 3000</span>

<span class="token doc-comment comment">/** 错误代码示例：不会有效执行的循环（不会按顺序执行） */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">Gen</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Gen</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Gen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> i
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// 输出：100, 2000, 3000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/willysliang/core/edit/master/blog/前端基础/ES6+语法Ⅱ.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页"><!--[--><!--]--> 编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">更新时间: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: willysliang">willy</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: willysliang@qq.com">willy</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/static_blog/assets/app-Bvx-HY_0.js" defer></script>
  </body>
</html>
